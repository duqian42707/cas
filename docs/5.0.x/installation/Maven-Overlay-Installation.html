<!DOCTYPE html>
<html>

<head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="CAS - Enterprise Single Sign-On for the Web"/>
    <meta name="keywords" content="authentication, login, cas, central authentication service, web, java, protocol, thymeleaf,
                   open source, boot, spring, authorization, google, facebook, twitter, higher-ed, enterprise,
                   access management, single signon, sso, RBAC, ABAC, attributes, SAML, OpenID, openid connect,
                   JWT, ADFS"/>
    <meta name="robots" content="index,follow"/>

    
    

        
    


    

    <script>
        ((i, s, o, g, r, a, m) => {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-83384532-2', 'auto');
        ga('send', 'pageview');

    </script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/>

    <link rel="stylesheet" type="text/css" media="screen" href="../../stylesheets/stylesheet.css">
    <link rel="stylesheet" type="text/css" media="print" href="../../stylesheets/print.css">

    <link href='https://fonts.googleapis.com/css?family=Lato:400,300,700' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic&subset=latin-ext,latin' rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" rel="stylesheet">

    <title>CAS - Overlay Installation</title>

</head>

<body>
<!-- HEADER -->
<header class="hidden-sm-down">
    <div class="container">
        <div class="row">
            <div class="col-xs-4 col-md-2">
                <a href="../../index.html">
                    <img class="undecorated" src="../../images/cas_logo.png"/>
                </a>
            </div>
            <div class="col-xs-8 col-md-6">
                <h1>Enterprise Single Sign-On for All</h1>
            </div>
            <div class="hidden-sm-down col-md-4">
                <a id="forkme_banner" href="https://github.com/apereo/cas">View on GitHub</a>
            </div>

        </div>
    </div>
</header>

<!-- NAVBAR -->

<nav class="navbar navbar-expand-md navbar-dark bg-primary bg-dark">
    <div class="container">
        <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="navbar-collapse collapse" id="navbarsExample04">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active"><a href="../../index.html" class="zoom nav-link">Home</a></li>
                <li class="nav-item"><a href="https://github.com/apereo/cas/releases" class="zoom nav-link">Releases</a></li>
                <li class="nav-item"><a href="../../Support.html" class="zoom nav-link">Support</a></li>
                <li class="nav-item"><a href="../../Mailing-Lists.html" class="zoom nav-link">Mailing Lists</a></li>
                <li class="nav-item">
                    <a class="zoom nav-link" href="../../Demos.html">Demos</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="zoom nav-link dropdown-toggle mr-md-2" href="#" id="cas-versions" data-bs-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">Versions</a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="cas-versions">
                        
                        
                        <a class="dropdown-item" href="/cas/development/">Development</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.6.x/">v6.6.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.5.x/">v6.5.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.4.x/">v6.4.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.3.x/">v6.3.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.2.x/">v6.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.1.x/">v6.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.0.x/">v6.0.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.3.x/">v5.3.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.2.x/">v5.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.1.x/">v5.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.0.x/">v5.0.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.2.x/">v4.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.1.x/">v4.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.0.x/">v4.0.x</a>
                        
                        

                    </div>
                </li>
                <li class="nav-item"><a href="https://apereo.github.io" target="_blank" class="zoom nav-link">Blog</a></li>
            </ul>

        </div>

    </div>
</nav>


<div class="container-fluid">
    <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 docs-sidebar pb-5" id="sidebar"></div>


        <div class="d-none d-xl-block col-xl-2 docs-toc">
    <div id="pageContents">
        <ul class="section-nav"></ul>
    </div>
</div>


        <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 cas-docs-content" role="main">


            

            <section>
                <nav id="docsNavBar">
                    <span id="toolbarIcons"></span>
                </nav>

                <div id="cas-docs-container">
                    <h1 id="war-overlay-installation">WAR Overlay Installation</h1>

<p>CAS installation is a fundamentally source-oriented process, and we recommend a
WAR overlay (1) project to organize
customizations such as component configuration and UI design.
The output of a WAR overlay build is a <code class="language-plaintext highlighter-rouge">cas.war</code> file that can be deployed to a servlet container like
<a href="http://tomcat.apache.org/whichversion.html">Tomcat</a>.</p>

<h2 id="what-is-a-war-overlay">What is a WAR Overlay?</h2>

<p>Overlays are a strategy to combat repetitive code and/or resources. Rather than downloading the CAS codebase and building from source,
overlays allow you to download a pre-built vanilla CAS web application server provided by the project itself and override/insert specific behavior into it.
At build time, the Maven/Gradle installation process will attempt to download the provided binary artifact first. Then the tool will locate your configuration files and settings made available inside the same project directory and will merge those into the downloaded artifact in order to produce
one wholesome archive (i.e. <code class="language-plaintext highlighter-rouge">cas.war</code>) . Overriden artifacts may include resources, java classes, images, CSS and javascript files. In order for the merge 
process is successfully execute, the location and names of the overriden artifacts locally must <strong>EXACTLY</strong> match that of those provided by the project
inside the originally downloaded archive.</p>

<p>It goes without saying that while up-front ramp-up time could be slightly complicated, there are significant advantages to this approach:</p>

<ol>
  <li>There is no need to download/build from the source.</li>
  <li>Upgrades are tremedously easier in most cases by simply adjusting the build script to download the newer CAS release.</li>
  <li>Rather than hosting the entire software source code, as the deployer you <strong>ONLY</strong> keep your own local customizations which makes change tracking much easier.</li>
  <li>Tracking changes inside a source control repository is very lightweight, again simply because only relevant changes (and not the entire software) is managed.</li>
</ol>

<p>WAR overlay projects are provided for reference and study.</p>

<div class="alert alert-info"><strong>Review Branch!</strong><p>The below repositories point you towards their <code>master</code> branch. 
You should always make sure the branch you are on matches the version of CAS you wish to configure and deploy. The <code>master</code> 
branch typically points to the latest stable release of the CAS server. Check the build configuration and if inappropriate, 
use <code>git branch -a</code> to see available branches, and then <code>git checkout [branch-name]</code> to switch if necessary.</p></div>

<h2 id="gradle">Gradle</h2>

<ul>
  <li><a href="https://github.com/apereo/cas-gradle-overlay-template">CAS Gradle Overlay</a></li>
</ul>

<h2 id="maven">Maven</h2>

<ul>
  <li><a href="https://github.com/apereo/cas-overlay-template">CAS Maven Overlay</a></li>
</ul>

<h2 id="docker">Docker</h2>

<ul>
  <li>See <a href="Docker-Installation.html">this guide</a> for more info.</li>
</ul>

<p>Every aspect of CAS can be controlled by
adding, removing, or modifying files in the overlay; it’s also possible and indeed common to customize the behavior of
CAS by adding third-party components that implement CAS APIs as Java source files or dependency references.</p>

<h2 id="servlet-container">Servlet Container</h2>

<p>CAS can be deployed to a number of servlet containers. See <a href="Configuring-Servlet-Container.html">this guide</a> for more info.</p>

<h2 id="spring-configuration">Spring Configuration</h2>

<p>CAS server depends heavily on the Spring framework. Two modes of configuration are available. Note that both modes
can be used at the same time.</p>

<h3 id="xml">XML</h3>

<p>There is a <code class="language-plaintext highlighter-rouge">src/main/resources/deployerConfigContext.xml</code> which CAS adopters may include in the overlay for environment-specific CAS settings. 
Note that in most cases, modifying this file should be unnecessary.</p>

<h3 id="groovy">Groovy</h3>

<p>The CAS application context is able to load a <code class="language-plaintext highlighter-rouge">src/main/resources/deployerConfigContext.groovy</code>. 
For advanced use cases, CAS beans can be dynamically defined via the <a href="http://www.groovy-lang.org/">Groovy programming language</a>.
As an example, here is an <code class="language-plaintext highlighter-rouge">exampleBean</code>:</p>

<div class="language-groovy highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="n">beans</span> <span class="o">{</span>
    <span class="n">xmlns</span><span class="o">([</span><span class="nl">context:</span><span class="s1">'http://www.springframework.org/schema/context'</span><span class="o">])</span>
    <span class="n">xmlns</span><span class="o">([</span><span class="nl">lang:</span><span class="s1">'http://www.springframework.org/schema/lang'</span><span class="o">])</span>
    <span class="n">xmlns</span><span class="o">([</span><span class="nl">util:</span><span class="s1">'http://www.springframework.org/schema/util'</span><span class="o">])</span>

    <span class="n">exampleBean</span><span class="o">(</span><span class="n">org</span><span class="o">.</span><span class="na">apereo</span><span class="o">.</span><span class="na">cas</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">ExampleBean</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">beanProperty</span> <span class="o">=</span> <span class="n">propertyValue</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Additionally, dynamic reloadable Groovy beans can be defined in the <code class="language-plaintext highlighter-rouge">src/main/resources/deployerConfigContext.xml</code>. These definitions
are directly read from a <code class="language-plaintext highlighter-rouge">.groovy</code> script which is monitored for changes and reloaded automatically.
Here is a dynamic <code class="language-plaintext highlighter-rouge">messenger</code> bean defined whose definition is read from a <code class="language-plaintext highlighter-rouge">Messenger.groovy</code> file,
and is monitored for changes every 5 seconds.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;lang:groovy</span> <span class="na">id=</span><span class="s">"messenger"</span>
    <span class="na">refresh-check-delay=</span><span class="s">"5000"</span> 
    <span class="na">script-source=</span><span class="s">"classpath:Messenger.groovy"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;lang:property</span> <span class="na">name=</span><span class="s">"message"</span> <span class="na">value=</span><span class="s">"Hello, CAS!"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/lang:groovy&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The contents of the <code class="language-plaintext highlighter-rouge">Messenger.groovy</code> must resolve to a valid Java class:</p>

<div class="language-groovy highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">ExampleMessenger</span> <span class="kd">implements</span> <span class="n">Messenger</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s2">"Welcome"</span>
    
    <span class="n">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">message</span>
    <span class="o">}</span>
    <span class="kt">void</span> <span class="nf">setMessage</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">message</span> <span class="o">=</span> <span class="n">message</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="custom-and-third-party-source">Custom and Third-Party Source</h2>

<p>It is common to customize or extend the functionality of CAS by developing Java components that implement CAS APIs or
to include third-party source by Maven dependency references. Including third-party source is trivial; simply include
the relevant dependency in the overlay <code class="language-plaintext highlighter-rouge">pom.xml</code> or <code class="language-plaintext highlighter-rouge">build.gradle</code> file. In order to include custom Java source, it should be included
under a <code class="language-plaintext highlighter-rouge">src/java/main</code> directory in the overlay project source tree.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>├── src
│   ├── main
│   │   ├── java
│   │   │   └── edu
│   │   │       └── vt
│   │   │           └── middleware
│   │   │               └── cas
│   │   │                   ├── audit
│   │   │                   │   ├── CompactSlf4jAuditTrailManager.java
│   │   │                   ├── authentication
│   │   │                   │   └── principal
│   │   │                   │       └── UsernamePasswordCredentialsToPrincipalResolver.java
│   │   │                   ├── services
│   │   │                   │   └── JsonServiceRegistryDao.java
│   │   │                   ├── util
│   │   │                   │   └── X509Helper.java
│   │   │                   └── web
│   │   │                       ├── HelpController.java
│   │   │                       ├── flow
│   │   │                       │   ├── AbstractForgottenCredentialAction.java
│   │   │                       └── util
│   │   │                           ├── ProtocolParameterAuthority.java
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="maven-caveat">Maven Caveat</h3>

<p>Also, note that for any custom Java component to compile and be included in the final <code class="language-plaintext highlighter-rouge">cas.war</code> file, the <code class="language-plaintext highlighter-rouge">pom.xml</code> 
in the Maven overlay must include a reference to the Maven Java compiler so classes can compile.</p>

<p>Here is a <em>sample</em> Maven build configuration:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>...

<span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
...
        <span class="nt">&lt;plugin&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>3.1<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;configuration&gt;</span>
                <span class="nt">&lt;source&gt;</span>${java.source.version}<span class="nt">&lt;/source&gt;</span>
                <span class="nt">&lt;target&gt;</span>${java.target.version}<span class="nt">&lt;/target&gt;</span>
            <span class="nt">&lt;/configuration&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
...
    <span class="nt">&lt;/plugins&gt;</span>
    <span class="nt">&lt;finalName&gt;</span>cas<span class="nt">&lt;/finalName&gt;</span>
<span class="nt">&lt;/build&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="dependency-management">Dependency Management</h2>

<p>Each release of CAS provides a curated list of dependencies it supports. In practice, you do not need to provide a version for any of 
these dependencies in your build configuration as the CAS distribution is managing that for you. When you upgrade CAS itself, 
these dependencies will be upgraded as well in a consistent way.</p>

<p>The curated list of dependencies contains a refined list of third party libraries. The list is available as a standard Bills of Materials (BOM).</p>

<p>To configure your project to inherit from the BOM, simply set the parent:</p>

<h3 id="maven-1">Maven</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;parent&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apereo.cas<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>cas-server-support-bom<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>${cas.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/parent&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Not everyone likes inheriting from the BOM. 
You may have your own corporate standard parent that you need to use, 
or you may just prefer to explicitly declare all your Maven configuration.</p>

<p>If you don’t want to use the <code class="language-plaintext highlighter-rouge">cas-server-support-bom</code>, you can still 
keep the benefit of the dependency management (but not the plugin management) 
by using a <code class="language-plaintext highlighter-rouge">scope=import</code> dependency:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;dependencyManagement&gt;</span>
     <span class="nt">&lt;dependencies&gt;</span>
     
        <span class="c">&lt;!-- Override a dependency by including it BEFORE the BOM --&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.group<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>artifact-name<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>X.Y.Z<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
             
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.apereo.cas<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>cas-server-support-bom<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${cas.version}<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>
<span class="nt">&lt;/dependencyManagement&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="gradle-1">Gradle</h3>

<p>To take advantage of the CAS BOM via Gradle, please <a href="https://plugins.gradle.org/plugin/io.spring.dependency-management">use this guide</a> 
and configure the Gradle build accordingly.</p>

<p><em>(1) http://maven.apache.org/plugins/maven-war-plugin/overlays.html</em></p>

                </div>
            </section>
        </main>
    </div>
</div>


<footer>
    <div class="container">
        CAS is supported by the <a href="https://www.apereo.org/">Apereo Foundation</a>.
    </div>
</footer>

<script>
    let pageSection = '';
</script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.2/js/tether.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script>

<script src="../../javascripts/URI.js"></script>
<script src="../../javascripts/main.js"></script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
</body>

</html>
