<!DOCTYPE html>
<html>

<head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="CAS - Enterprise Single Sign-On for the Web"/>
    <meta name="keywords" content="authentication, login, cas, central authentication service, web, java, protocol, thymeleaf,
                   open source, boot, spring, authorization, google, facebook, twitter, higher-ed, enterprise,
                   access management, single signon, sso, RBAC, ABAC, attributes, SAML, OpenID, openid connect,
                   JWT, ADFS"/>
    <meta name="robots" content="index,follow"/>

    
    

        
    


    

    <script>
        ((i, s, o, g, r, a, m) => {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-83384532-2', 'auto');
        ga('send', 'pageview');

    </script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/>

    <link rel="stylesheet" type="text/css" media="screen" href="../../stylesheets/stylesheet.css">
    <link rel="stylesheet" type="text/css" media="print" href="../../stylesheets/print.css">

    <link href='https://fonts.googleapis.com/css?family=Lato:400,300,700' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic&subset=latin-ext,latin' rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" rel="stylesheet">

    <title>CAS - OpenID Connect Authentication</title>

</head>

<body>
<!-- HEADER -->
<header class="hidden-sm-down">
    <div class="container">
        <div class="row">
            <div class="col-xs-4 col-md-2">
                <a href="../../index.html">
                    <img class="undecorated" src="../../images/cas_logo.png"/>
                </a>
            </div>
            <div class="col-xs-8 col-md-6">
                <h1>Enterprise Single Sign-On for All</h1>
            </div>
            <div class="hidden-sm-down col-md-4">
                <a id="forkme_banner" href="https://github.com/apereo/cas">View on GitHub</a>
            </div>

        </div>
    </div>
</header>

<!-- NAVBAR -->

<nav class="navbar navbar-expand-md navbar-dark bg-primary bg-dark">
    <div class="container">
        <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="navbar-collapse collapse" id="navbarsExample04">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active"><a href="../../index.html" class="zoom nav-link">Home</a></li>
                <li class="nav-item"><a href="https://github.com/apereo/cas/releases" class="zoom nav-link">Releases</a></li>
                <li class="nav-item"><a href="../../Support.html" class="zoom nav-link">Support</a></li>
                <li class="nav-item"><a href="../../Mailing-Lists.html" class="zoom nav-link">Mailing Lists</a></li>
                <li class="nav-item">
                    <a class="zoom nav-link" href="../../Demos.html">Demos</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="zoom nav-link dropdown-toggle mr-md-2" href="#" id="cas-versions" data-bs-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">Versions</a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="cas-versions">
                        
                        
                        <a class="dropdown-item" href="/cas/development/">Development</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.6.x/">v6.6.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.5.x/">v6.5.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.4.x/">v6.4.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.3.x/">v6.3.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.2.x/">v6.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.1.x/">v6.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.0.x/">v6.0.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.3.x/">v5.3.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.2.x/">v5.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.1.x/">v5.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.0.x/">v5.0.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.2.x/">v4.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.1.x/">v4.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.0.x/">v4.0.x</a>
                        
                        

                    </div>
                </li>
                <li class="nav-item"><a href="https://apereo.github.io" target="_blank" class="zoom nav-link">Blog</a></li>
            </ul>

        </div>

    </div>
</nav>


<div class="container-fluid">
    <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 docs-sidebar pb-5" id="sidebar"></div>


        <div class="d-none d-xl-block col-xl-2 docs-toc">
    <div id="pageContents">
        <ul class="section-nav"></ul>
    </div>
</div>


        <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 cas-docs-content" role="main">


            

            <section>
                <nav id="docsNavBar">
                    <span id="toolbarIcons"></span>
                </nav>

                <div id="cas-docs-container">
                    <h1 id="openid-connect-authentication">OpenID Connect Authentication</h1>

<p>Allow CAS to act as an <a href="http://openid.net/connect/">OpenId Connect Provider (OP)</a>.</p>

<div class="alert alert-info"><strong>Remember</strong><p>OpenId Connect is a continuation of the <a href="OAuth-OpenId-Authentication.html">OAuth protocol</a> with some additional variations. If you enable OpenId Connect, you will have automatically enabled OAuth as well. Options and behaviors that are documented for the <a href="OAuth-OpenId-Authentication.html">OAuth protocol</a> support may apply here just the same.</p></div>

<p>Support is enabled by including the following dependency in the WAR overlay:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.apereo.cas<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>cas-server-support-oidc<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>${cas.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>To learn more about OpenId Connect, please <a href="http://openid.net/specs/openid-connect-basic-1_0.html">review this guide</a>.</p>

<p>The current implementation provides support for:</p>

<ul>
  <li><a href="http://openid.net/specs/openid-connect-basic-1_0.html">Authorization Code Flow</a></li>
  <li><a href="https://openid.net/specs/openid-connect-implicit-1_0.html">Implicit Flow</a></li>
  <li><a href="https://openid.net/specs/openid-connect-discovery-1_0.html">Dynamic Discovery</a></li>
  <li><a href="https://openid.net/specs/openid-connect-discovery-1_0-21.html">WebFinger Issuer Discovery</a></li>
  <li>Administration and registration of <a href="../services/Service-Management.html">OIDC clients and relying parties</a>.</li>
  <li>Administration and registration of <a href="../services/Service-Management.html">OIDC clients and relying parties</a> via <a href="https://tools.ietf.org/html/draft-ietf-oauth-dyn-reg-management-01">Dynamic Client Registration protocol</a>.</li>
  <li>Ability to <a href="../integration/Attribute-Release-Policies.html">resolve, map and release claims</a>.</li>
  <li>Ability to configure expiration policies for various tokens.</li>
</ul>

<h2 id="endpoints">Endpoints</h2>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/oidc/.well-known</code></td>
      <td>The discovery endpoint used to query for CAS OIDC configuration information and metadata.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/oidc/.well-known/openid-configuration</code></td>
      <td>Same as <code class="language-plaintext highlighter-rouge">.well-known</code> discovery endpoint.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/oidc/.well-known/webfinger</code></td>
      <td><a href="https://tools.ietf.org/html/rfc7033">WebFinger</a> discovery endpoint</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/oidc/jwks</code></td>
      <td>Contains the server’s public signing keys, which clients may use to verify the digital signatures of access tokens and ID tokens issued by CAS.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/oidc/authorize</code></td>
      <td>Authorization requests are handled here.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/oidc/profile</code></td>
      <td>User profile requests are handled here.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/oidc/introspect</code></td>
      <td>Query CAS to detect the status of a given access token via <a href="https://tools.ietf.org/html/rfc7662">introspection</a>. This endpoint expects HTTP basic authentication with OIDC service <code class="language-plaintext highlighter-rouge">client_id</code> and <code class="language-plaintext highlighter-rouge">client_secret</code> associated as username and password.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/oidc/accessToken</code>, <code class="language-plaintext highlighter-rouge">/oidc/token</code></td>
      <td>Produces authorized access tokens.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/oidc/revoke</code></td>
      <td><a href="https://tools.ietf.org/html/rfc7009">Revoke</a> access or refresh tokens. This endpoint expects HTTP basic authentication with OIDC service <code class="language-plaintext highlighter-rouge">client_id</code> and <code class="language-plaintext highlighter-rouge">client_secret</code> associated as username and password.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/oidc/register</code></td>
      <td>Register clients via the <a href="https://tools.ietf.org/html/draft-ietf-oauth-dyn-reg-management-01">dynamic client registration</a> protocol.</td>
    </tr>
  </tbody>
</table>

<h2 id="register-clients">Register Clients</h2>

<p>Clients can be registered with CAS in the following ways.</p>

<h3 id="statically">Statically</h3>

<p>OpenID Connect clients can be <em>statically</em> registered with CAS as such:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.apereo.cas.services.OidcRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientSecret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"secret"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"^&lt;https://the-redirect-uri&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OIDC"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>Note that OpenID connect clients as service definitions are an extension of <a href="OAuth-OpenId-Authentication.html">OAuth services</a> in CAS. All settings that apply to an OAuth service definition should equally apply here as well. 
The following fields are specifically available for OpenID connect services:</p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">clientId</code></td>
      <td>Required. The identifier for this client application.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">clientSecret</code></td>
      <td>Required. The secret for this client application.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">serviceId</code></td>
      <td>Required. The authorized redirect URI for this OIDC client.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">supportedGrantTypes</code></td>
      <td>Optional. Collection of supported grant types for this service.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">supportedResponseTypes</code></td>
      <td>Optional. Collection of supported response types for this service.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">signIdToken</code></td>
      <td>Optional. Whether ID tokens should be signed. Default is <code class="language-plaintext highlighter-rouge">true</code>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">jwks</code></td>
      <td>Optional. Resource path to the keystore location that holds the keys for this application.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">jwksCacheDuration</code></td>
      <td>Optional. The expiration policy time value applied to loaded/cached keys for this application.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">jwksCacheTimeUnit</code></td>
      <td>Optional. The expiration policy time unit of measure (i.e. <code class="language-plaintext highlighter-rouge">seconds</code>, <code class="language-plaintext highlighter-rouge">minutes</code>, etc) applied to loaded/cached keys.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">encryptIdToken</code></td>
      <td>Optional. Whether ID tokens should be encrypted. Default is <code class="language-plaintext highlighter-rouge">false</code>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">idTokenEncryptionAlg</code></td>
      <td>Optional. The algorithm header value used to encrypt the id token.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">idTokenSigningAlg</code></td>
      <td>Optional. The algorithm header value used to sign the id token.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">userInfoSigningAlg</code></td>
      <td>Optional. The algorithm header value used to sign user profile responses.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">userInfoEncryptedResponseAlg</code></td>
      <td>Optional. The algorithm header value used to encrypt user profile responses.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">tokenEndpointAuthenticationMethod</code></td>
      <td>Optional. The requested client authentication method to the token endpoint. Default is <code class="language-plaintext highlighter-rouge">client_secret_basic</code>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">applicationType</code></td>
      <td>Optional. <code class="language-plaintext highlighter-rouge">web</code>, <code class="language-plaintext highlighter-rouge">native</code>, or blank. Defined the kind of the application. The default, if omitted, is <code class="language-plaintext highlighter-rouge">web</code>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">idTokenEncryptionEncoding</code></td>
      <td>Optional. The algorithm method header value used to encrypt the id token.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">userInfoEncryptedResponseEncoding</code></td>
      <td>Optional. The algorithm method header value used to encrypt the user profile response.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">subjectType</code></td>
      <td>Optional value chosen from <code class="language-plaintext highlighter-rouge">public</code> or <code class="language-plaintext highlighter-rouge">pairwise</code>. Type to use when generating principal identifiers. Default is <code class="language-plaintext highlighter-rouge">public</code>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">sectorIdentifierUri</code></td>
      <td>Optional. Host value of this URL is used as the sector identifier for the pairwise identifier calculation. If left undefined, the host value of the <code class="language-plaintext highlighter-rouge">serviceId</code> will be used instead.</td>
    </tr>
  </tbody>
</table>

<div class="alert alert-info"><strong>Keep What You Need!</strong><p>You are encouraged to only keep and maintain properties and settings needed for a 
particular integration. It is UNNECESSARY to grab a copy of all service fields and try to configure them yet again based on their default. While 
you may wish to keep a copy as a reference, this strategy would ultimately lead to poor upgrades increasing chances of breaking changes and a messy 
deployment at that.</p></div>

<p>Service definitions are typically managed and registered with CAS by the <a href="../services/Service-Management.html">service management</a> facility.</p>

<div class="alert alert-warning"><strong>Usage Warning!</strong><p>CAS today does not strictly enforce the collection of authorized supported 
response/grant types for backward compatibility reasons if left blank. This means that if left undefined, all grant and response types may be allowed by 
the service definition and related policies. Do please note that this behavior is <strong>subject to change</strong> in future releases 
and thus, it is strongly recommended that all authorized grant/response types for each profile be declared in the service definition 
immediately to avoid surprises in the future.</p></div>

<h3 id="dynamically">Dynamically</h3>

<p>Client applications may dynamically be registered with CAS for authentication. By default, CAS operates 
in a <code class="language-plaintext highlighter-rouge">PROTECTED</code> mode where the registration endpoint requires user authentication. This behavior may be relaxed via 
CAS settings to allow CAS to operate in an <code class="language-plaintext highlighter-rouge">OPEN</code> mode.</p>

<h2 id="settings">Settings</h2>

<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#openid-connect">review this guide</a>.</p>

<h2 id="server-configuration">Server Configuration</h2>

<p>Remember that OpenID Connect features of CAS require session affinity (and optionally session replication),
as the authorization responses throughout the login flow are stored via server-backed session storage mechanisms. 
You will need to configure your deployment environment and load-balancers accordingly.</p>

<h2 id="sample-client-applications">Sample Client Applications</h2>

<ul>
  <li><a href="https://github.com/cas-projects/oidc-sample-java-webapp">MITREid Sample Java Webapp</a></li>
</ul>

<h2 id="claims">Claims</h2>

<p>OpenID connect claims are simply treated as normal CAS attributes that need to
be <a href="../integration/Attribute-Release-Policies.html">resolved, mapped and released</a>.</p>

<h3 id="scope-based-claims">Scope-based Claims</h3>

<p>You may chain various attribute release policies that authorize claim release based on specific scopes:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.apereo.cas.services.OidcRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientSecret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OIDC Test"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="nl">"scopes"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"java.util.HashSet"</span><span class="p">,</span><span class="w"> 
    </span><span class="p">[</span><span class="w"> </span><span class="s2">"profile"</span><span class="p">,</span><span class="w"> </span><span class="s2">"email"</span><span class="p">,</span><span class="w"> </span><span class="s2">"address"</span><span class="p">,</span><span class="w"> </span><span class="s2">"phone"</span><span class="p">,</span><span class="w"> </span><span class="s2">"offline_access"</span><span class="p">,</span><span class="w"> </span><span class="s2">"displayName"</span><span class="p">,</span><span class="w"> </span><span class="s2">"eduPerson"</span><span class="w"> </span><span class="p">]</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>Standard scopes that internally catalog pre-defined claims all belong to the namespace <code class="language-plaintext highlighter-rouge">org.apereo.cas.oidc.claims</code> and are described below:</p>

<table>
  <thead>
    <tr>
      <th>Policy</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">o.a.c.o.c.OidcProfileScopeAttributeReleasePolicy</code></td>
      <td>Release claims mapped to the spec-predefined <code class="language-plaintext highlighter-rouge">profile</code> scope.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">o.a.c.o.c.OidcEmailScopeAttributeReleasePolicy</code></td>
      <td>Release claims mapped to the spec-predefined <code class="language-plaintext highlighter-rouge">email</code> scope.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">o.a.c.o.c.OidcAddressScopeAttributeReleasePolicy</code></td>
      <td>Release claims mapped to the spec-predefined <code class="language-plaintext highlighter-rouge">address</code> scope.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">o.a.c.o.c.OidcPhoneScopeAttributeReleasePolicy</code></td>
      <td>Release claims mapped to the spec-predefined <code class="language-plaintext highlighter-rouge">phone</code> scope.</td>
    </tr>
  </tbody>
</table>

<h3 id="mapping-claims">Mapping Claims</h3>

<p>Claims associated with a scope (i.e. <code class="language-plaintext highlighter-rouge">given_name</code> for <code class="language-plaintext highlighter-rouge">profile</code>) are fixed in 
the <a href="http://openid.net/specs/openid-connect-basic-1_0.html">OpenID specification</a>. In the 
event that custom arbitrary attributes should be mapped to claims, mappings can be defined in CAS 
settings to link a CAS-defined attribute to a fixed given scope. For instance, CAS configuration may 
allow the value of the attribute <code class="language-plaintext highlighter-rouge">sys_given_name</code> to be mapped and assigned to the claim <code class="language-plaintext highlighter-rouge">given_name</code> 
without having an impact on the attribute resolution configuration and all other CAS-enabled applications.</p>

<p>If mapping is not defined, by default CAS attributes are expected to match claim names.</p>

<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#openid-connect">review this guide</a>.</p>

<h3 id="user-defined-scopes">User-Defined Scopes</h3>

<p>Note that in addition to standard system scopes, you may define your own custom scope with a number of attributes within:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.apereo.cas.services.OidcRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientSecret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OIDC Test"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="nl">"scopes"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"java.util.HashSet"</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"displayName"</span><span class="p">,</span><span class="w"> </span><span class="s2">"eduPerson"</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>These such as <code class="language-plaintext highlighter-rouge">displayName</code> above, get bundled into a <code class="language-plaintext highlighter-rouge">custom</code> scope which can be used and requested by services and clients.</p>

<p>If you however wish to define your custom scopes as an extension of what OpenID Connect defines
such that you may bundle attributes together, then you need to first register your <code class="language-plaintext highlighter-rouge">scope</code>,
define its attribute bundle and then use it a given service definition such as <code class="language-plaintext highlighter-rouge">eduPerson</code> above.
Such user-defined scopes are also able to override the definition of system scopes.</p>

<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#openid-connect">review this guide</a>.</p>

<h3 id="releasing-claims">Releasing Claims</h3>

<p>Defined scopes for a given service definition control and build attribute release policies internally. Such attribute release
policies allow one to release standard claims, remap attributes to standard claims, or define custom claims and scopes altogether.</p>

<p>It is also possible to define and use <em>free-form</em> attribute release policies outside the confines of a <em>scope</em> to freely build and release claims/attributes.</p>

<p>For example, the following service definition will decide on relevant attribute release policies based on the semantics
of the scopes <code class="language-plaintext highlighter-rouge">profile</code> and <code class="language-plaintext highlighter-rouge">email</code>. There is no need to design or list individual claims as CAS will auto-configure
the relevant attribute release policies:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.apereo.cas.services.OidcRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientSecret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"secret"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OIDC"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"scopes"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"java.util.HashSet"</span><span class="p">,</span><span class="w">
    </span><span class="p">[</span><span class="w"> </span><span class="s2">"profile"</span><span class="p">,</span><span class="w"> </span><span class="s2">"email"</span><span class="w"> </span><span class="p">]</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>A <em>scope-free</em> attribute release policy may just as equally apply, allowing one in 
the following example to release <code class="language-plaintext highlighter-rouge">userX</code> as a <em>claim</em>:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.apereo.cas.services.OidcRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientSecret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"secret"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OIDC"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"attributeReleasePolicy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.apereo.cas.services.ReturnMappedAttributeReleasePolicy"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"allowedAttributes"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"java.util.TreeMap"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"userX"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"groovy { return attributes['uid'].get(0) + '-X' }"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>It is also possible to mix <em>free-form</em> release policies with those that operate based on a scope by chaining such policies together. For example, the below policy
allows the release of <code class="language-plaintext highlighter-rouge">user-x</code> as a claim, as well as all claims assigned and internally defined for the standard <code class="language-plaintext highlighter-rouge">email</code> scope.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"org.apereo.cas.services.OidcRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientSecret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"secret"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OIDC"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="nl">"attributeReleasePolicy"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"@class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"org.apereo.cas.services.ChainingAttributeReleasePolicy"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"policies"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"java.util.ArrayList"</span><span class="p">,</span><span class="w">
      </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.apereo.cas.services.ReturnAllowedAttributeReleasePolicy"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"allowedAttributes"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"java.util.ArrayList"</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"cn"</span><span class="p">,</span><span class="w"> </span><span class="s2">"uid"</span><span class="p">,</span><span class="w"> </span><span class="s2">"givenName"</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">],</span><span class="w">
          </span><span class="nl">"order"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"@class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"org.apereo.cas.services.ReturnMappedAttributeReleasePolicy"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"allowedAttributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"@class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"java.util.TreeMap"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"user-x"</span><span class="p">:</span><span class="w"> </span><span class="s2">"groovy { return attributes['uid'].get(0) + '-X' }"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="nl">"order"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"@class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"org.apereo.cas.oidc.claims.OidcEmailScopeAttributeReleasePolicy"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"order"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>To learn more about attribute release policies and the chain of command, please <a href="../integration/Attribute-Release-Policies.html">see this guide</a>.</p>

<h2 id="authentication-context-class">Authentication Context Class</h2>

<p>Support for authentication context class references is implemented in form of <code class="language-plaintext highlighter-rouge">acr_values</code> as part of the original 
authorization request, which is mostly taken into account by 
the <a href="../mfa/Configuring-Multifactor-Authentication.html">multifactor authentication features</a> of CAS. 
Once successful, <code class="language-plaintext highlighter-rouge">acr</code> and <code class="language-plaintext highlighter-rouge">amr</code> values are passed back to the relying party as part of the id token.</p>

<h2 id="pairwise-identifiers">Pairwise Identifiers</h2>

<p>When <code class="language-plaintext highlighter-rouge">pairwise</code> subject type is used, CAS will calculate a unique <code class="language-plaintext highlighter-rouge">sub</code> value for each sector identifier. This identifier 
should not be reversible by any party other than CAS and is somewhat akin to CAS generating persistent anonymous user 
identifiers. Each value provided to every relying party is different so as not to enable clients to correlate the user’s activities without permission.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.apereo.cas.services.OidcRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"clientSecret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"secret"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"^&lt;https://the-redirect-uri&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"usernameAttributeProvider"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.apereo.cas.services.PairwiseOidcRegisteredServiceUsernameAttributeProvider"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"persistentIdGenerator"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.apereo.cas.authentication.principal.OidcPairwisePersistentIdGenerator"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"salt"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"aGVsbG93b3JsZA=="</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="keystores">Keystores</h2>

<p>Each registered application in CAS can contain its own keystore as a <code class="language-plaintext highlighter-rouge">jwks</code> resource. By default,
a global keystore can be expected and defined via CAS properties. The format of the keystore
file is similar to the following:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"keys"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"d"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"e"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AQAB"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"n"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"kty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RSA"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"kid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cas"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>CAS will attempt to auto-generate a keystore if it can’t find one, but if you wish to generate one manually, 
a JWKS can be generated using <a href="https://mkjwk.org/">this tool</a>
or <a href="http://connect2id.com/products/nimbus-jose-jwt/generator">this tool</a>.</p>

<h2 id="webfinger-issuer-discovery">WebFinger Issuer Discovery</h2>

<p>OpenID Provider Issuer discovery is the process of determining the location of the OpenID Provider. Issuer discovery is optional; if a Relying Party 
knows the OP’s Issuer location through an out-of-band mechanism, it can skip this step.</p>

<p>Issuer discovery requires the following information to make a discovery request:</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td>Required. Identifier for the target End-User that is the subject of the discovery request.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">host</code></td>
      <td>Server where a WebFinger service is hosted.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rel</code></td>
      <td>URI identifying the type of service whose location is being requested:<code class="language-plaintext highlighter-rouge">http://openid.net/specs/connect/1.0/issuer</code></td>
    </tr>
  </tbody>
</table>

<p>To start discovery of OpenID endpoints, the End-User supplies an Identifier to the Relying Party. The RP applies normalization rules to the Identifier to
determine the Resource and Host. Then it makes an HTTP <code class="language-plaintext highlighter-rouge">GET</code> request to the CAS WebFinger endpoint with the <code class="language-plaintext highlighter-rouge">resource</code> and <code class="language-plaintext highlighter-rouge">rel</code> parameters to obtain 
the location of the requested service. The Issuer location <strong>MUST</strong> be returned in the WebFinger response as the value 
of the <code class="language-plaintext highlighter-rouge">href</code> member of a links array element with <code class="language-plaintext highlighter-rouge">rel</code> member value <code class="language-plaintext highlighter-rouge">http://openid.net/specs/connect/1.0/issuer</code>.</p>

<p>Example invocation of the <code class="language-plaintext highlighter-rouge">webfinger</code> endpoint follows:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl https://sso.example.org/cas/oidc/.well-known/webfinger?resource<span class="o">=</span>acct:casuser@somewhere.example.org
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The expected response shall match the following example:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"acct:casuser@somewhere.example.org"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"rel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://openid.net/specs/connect/1.0/issuer"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://sso.example.org/cas/oidc/"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#openid-connect-webfinger">review this guide</a>.</p>

<h3 id="webfinger-resource-userinfo">WebFinger Resource UserInfo</h3>

<p>To determine the correct issuer, resources that are provided to the <code class="language-plaintext highlighter-rouge">webfinger</code> discovery endpoint using the <code class="language-plaintext highlighter-rouge">acct</code> URI scheme
can be located and fetched using external user repositories via <code class="language-plaintext highlighter-rouge">email</code> or <code class="language-plaintext highlighter-rouge">username</code>.</p>

<div class="alert alert-warning"><strong>Usage Warning!</strong><p>The default repository implementation will 
simply echo back the provided email or username, etc as it is <strong>ONLY</strong> relevant for demo/testing purposes.</p></div>

<p>The following user-info repository choices are available for configuration and production use.</p>

<h4 id="groovy-userinfo-repository">Groovy UserInfo Repository</h4>

<p>The task of locating accounts linked to webfinger resources can be handled using an external Groovy script whose outline would match the following:</p>

<div class="language-groovy highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="kt">def</span> <span class="nf">findByUsername</span><span class="o">(</span><span class="n">Object</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">def</span> <span class="n">username</span> <span class="o">=</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
    <span class="kt">def</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
    <span class="k">return</span> <span class="o">[</span><span class="nl">username:</span> <span class="n">username</span><span class="o">]</span>
<span class="o">}</span>

<span class="kt">def</span> <span class="nf">findByEmailAddress</span><span class="o">(</span><span class="n">Object</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">def</span> <span class="n">email</span> <span class="o">=</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
    <span class="kt">def</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
    <span class="k">return</span> <span class="o">[</span><span class="nl">email:</span> <span class="n">email</span><span class="o">]</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The expected return value from the script is a <code class="language-plaintext highlighter-rouge">Map</code> that contains key-value objects, representing user account details. An empty <code class="language-plaintext highlighter-rouge">Map</code>
would indicate the absence of the user record, leading to a <code class="language-plaintext highlighter-rouge">404</code> response status back to the relying party.</p>

<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#openid-connect-webfinger">review this guide</a>.</p>

<h4 id="rest-userinfo-repository">REST UserInfo Repository</h4>

<p>The REST repository allows the CAS server to reach to a remote REST endpoint via the configured HTTP method to fetch user account information.</p>

<p>Query data is passed via either <code class="language-plaintext highlighter-rouge">email</code> or <code class="language-plaintext highlighter-rouge">username</code> HTTP headers. The response that is returned must be accompanied by a <code class="language-plaintext highlighter-rouge">200</code>
status code where the body should contain <code class="language-plaintext highlighter-rouge">Map</code> representing the user account information. All other responses will lead to a <code class="language-plaintext highlighter-rouge">404</code> 
response status back to the relying party.</p>

<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#openid-connect-webfinger">review this guide</a>.</p>

<h4 id="custom-userinfo-repository">Custom UserInfo Repository</h4>

<p>It is possible to design and inject your own version of webfinger user repositories into CAS. First, you will need to design
a <code class="language-plaintext highlighter-rouge">@Configuration</code> class to contain your own <code class="language-plaintext highlighter-rouge">OidcWebFingerUserInfoRepository</code> implementation:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="nd">@Configuration</span><span class="o">(</span><span class="s">"customWebFingerUserInfoConfiguration"</span><span class="o">)</span>
<span class="nd">@EnableConfigurationProperties</span><span class="o">(</span><span class="nc">CasConfigurationProperties</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomWebFingerUserInfoConfiguration</span> <span class="o">{</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">OidcWebFingerUserInfoRepository</span> <span class="nf">oidcWebFingerUserInfoRepository</span><span class="o">()</span> <span class="o">{</span>
        <span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Your configuration class needs to be registered with CAS. <a href="../configuration/Configuration-Management-Extensions.html">See this guide</a> for better details.</p>

                </div>
            </section>
        </main>
    </div>
</div>


<footer>
    <div class="container">
        CAS is supported by the <a href="https://www.apereo.org/">Apereo Foundation</a>.
    </div>
</footer>

<script>
    let pageSection = 'Authentication';
</script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.2/js/tether.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script>

<script src="../../javascripts/URI.js"></script>
<script src="../../javascripts/main.js"></script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
</body>

</html>
