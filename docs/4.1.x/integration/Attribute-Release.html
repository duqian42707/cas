<!DOCTYPE html>
<html>

<head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="CAS - Enterprise Single Sign-On for the Web"/>
    <meta name="keywords" content="authentication, login, cas, central authentication service, web, java, protocol, thymeleaf,
                   open source, boot, spring, authorization, google, facebook, twitter, higher-ed, enterprise,
                   access management, single signon, sso, RBAC, ABAC, attributes, SAML, OpenID, openid connect,
                   JWT, ADFS"/>
    <meta name="robots" content="index,follow"/>

    
    

        
    


    

    <script>
        ((i, s, o, g, r, a, m) => {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-83384532-2', 'auto');
        ga('send', 'pageview');

    </script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/>

    <link rel="stylesheet" type="text/css" media="screen" href="../../stylesheets/stylesheet.css">
    <link rel="stylesheet" type="text/css" media="print" href="../../stylesheets/print.css">

    <link href='https://fonts.googleapis.com/css?family=Lato:400,300,700' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic&subset=latin-ext,latin' rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" rel="stylesheet">

    <title>CAS - Attribute Release</title>

</head>

<body>
<!-- HEADER -->
<header class="hidden-sm-down">
    <div class="container">
        <div class="row">
            <div class="col-xs-4 col-md-2">
                <a href="../../index.html">
                    <img class="undecorated" src="../../images/cas_logo.png"/>
                </a>
            </div>
            <div class="col-xs-8 col-md-6">
                <h1>Enterprise Single Sign-On for All</h1>
            </div>
            <div class="hidden-sm-down col-md-4">
                <a id="forkme_banner" href="https://github.com/apereo/cas">View on GitHub</a>
            </div>

        </div>
    </div>
</header>

<!-- NAVBAR -->

<nav class="navbar navbar-expand-md navbar-dark bg-primary bg-dark">
    <div class="container">
        <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="navbar-collapse collapse" id="navbarsExample04">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active"><a href="../../index.html" class="zoom nav-link">Home</a></li>
                <li class="nav-item"><a href="https://github.com/apereo/cas/releases" class="zoom nav-link">Releases</a></li>
                <li class="nav-item"><a href="../../Support.html" class="zoom nav-link">Support</a></li>
                <li class="nav-item"><a href="../../Mailing-Lists.html" class="zoom nav-link">Mailing Lists</a></li>
                <li class="nav-item">
                    <a class="zoom nav-link" href="../../Demos.html">Demos</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="zoom nav-link dropdown-toggle mr-md-2" href="#" id="cas-versions" data-bs-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">Versions</a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="cas-versions">
                        
                        
                        <a class="dropdown-item" href="/cas/development/">Development</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.6.x/">v6.6.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.5.x/">v6.5.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.4.x/">v6.4.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.3.x/">v6.3.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.2.x/">v6.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.1.x/">v6.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.0.x/">v6.0.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.3.x/">v5.3.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.2.x/">v5.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.1.x/">v5.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.0.x/">v5.0.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.2.x/">v4.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.1.x/">v4.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.0.x/">v4.0.x</a>
                        
                        

                    </div>
                </li>
                <li class="nav-item"><a href="https://apereo.github.io" target="_blank" class="zoom nav-link">Blog</a></li>
            </ul>

        </div>

    </div>
</nav>


<div class="container-fluid">
    <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 docs-sidebar pb-5" id="sidebar"></div>


        <div class="d-none d-xl-block col-xl-2 docs-toc">
    <div id="pageContents">
        <ul class="section-nav"></ul>
    </div>
</div>


        <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 cas-docs-content" role="main">


            

            <section>
                <nav id="docsNavBar">
                    <span id="toolbarIcons"></span>
                </nav>

                <div id="cas-docs-container">
                    <h1 id="attribute-release">Attribute Release</h1>
<p>Resolved attributes are returned to scoped services via the <a href="../protocol/SAML-Protocol.html">SAML 1.1 protocol</a> or the <a href="../protocol/CAS-Protocol.html">CAS protocol</a>.</p>

<p>Attributes pass through a two-step process:</p>

<ul>
  <li><a href="Attribute-Resolution.html">Attribute Resolution</a>: Done at the time of establishing the principal, <em>usually</em> via <code class="language-plaintext highlighter-rouge">PrincipalResolver</code> components where attributes are resolved from various sources.</li>
  <li>Attribute Release: Adopters must explicitly configure attribute release for services in order for the resolved attributes to be released to a service in the validation response.</li>
</ul>

<div class="alert alert-info"><strong>Service Management</strong><p>Attribute release may also be configured via the
<a href="../installation/Service-Management.html">Service Management tool</a>.</p></div>

<h2 id="principal-id-attribute">Principal-Id Attribute</h2>
<p>The service registry component of CAS has the ability to allow for configuration of a <code class="language-plaintext highlighter-rouge">usernameAttributeProvider</code> to be returned for the given registered service. When this property is set for a service, CAS will return the value of the configured attribute as part of its validation process.</p>

<ul>
  <li>Ensure the attribute is available and resolved for the principal</li>
  <li>Set the <code class="language-plaintext highlighter-rouge">usernameAttributeProvider</code> property of the given service to once of the attribute providers below</li>
</ul>

<h3 id="defaultregisteredserviceusernameprovider"><code class="language-plaintext highlighter-rouge">DefaultRegisteredServiceUsernameProvider</code></h3>
<p>The default configuration which need not explicitly be defined, simply returns the resolved principal id as the username for this service.</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.RegexRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<h3 id="principalattributeregisteredserviceusernameprovider"><code class="language-plaintext highlighter-rouge">PrincipalAttributeRegisteredServiceUsernameProvider</code></h3>
<p>Returns an attribute that is already resolved for the principal as the username for this service. If the attribute
is not available, the default principal id will be used.</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.RegexRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"usernameAttributeProvider"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.PrincipalAttributeRegisteredServiceUsernameProvider"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"usernameAttribute"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"cn"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<h3 id="anonymousregisteredserviceusernameattributeprovider"><code class="language-plaintext highlighter-rouge">AnonymousRegisteredServiceUsernameAttributeProvider</code></h3>
<p>Provides an opaque identifier for the username. The opaque identifier by default conforms to the requirements
of the <a href="http://www.incommon.org/federation/attributesummary.html#eduPersonTargetedID">eduPersonTargetedID</a> attribute.</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.RegexRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"usernameAttributeProvider"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.AnonymousRegisteredServiceUsernameAttributeProvider"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"persistentIdGenerator"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.authentication.principal.ShibbolethCompatiblePersistentIdGenerator"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"salt"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"aGVsbG93b3JsZA=="</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<h2 id="attribute-release-policy">Attribute Release Policy</h2>
<p>Once principal attributes are <a href="Attribute-Resolution.html">resolved</a>, adopters may choose to allow/release each attribute per each definition in the registry.</p>

<p>The release policy decides how attributes are to be released for a given service. Each policy has the ability to apply an optional filter.</p>

<p>The following settings are shared by all attribute release policies:</p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">authorizedToReleaseCredentialPassword</code></td>
      <td>Boolean to define whether the service is authorized to <a href="ClearPass.html">release the credential as an attribute</a>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">authorizedToReleaseProxyGrantingTicket</code></td>
      <td>Boolean to define whether the service is authorized to <a href="../installation/Configuring-Proxy-Authentication.html">release the proxy-granting ticket id as an attribute</a></td>
    </tr>
  </tbody>
</table>

<h3 id="components">Components</h3>

<h4 id="returnallattributereleasepolicy"><code class="language-plaintext highlighter-rouge">ReturnAllAttributeReleasePolicy</code></h4>
<p>Return all resolved attributes to the service.</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.RegexRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"attributeReleasePolicy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.ReturnAllAttributeReleasePolicy"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<h4 id="returnallowedattributereleasepolicy"><code class="language-plaintext highlighter-rouge">ReturnAllowedAttributeReleasePolicy</code></h4>
<p>Only return the attributes that are explicitly allowed by the configuration.</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.RegexRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"attributeReleasePolicy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.ReturnAllowedAttributeReleasePolicy"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"allowedAttributes"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"java.util.ArrayList"</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"cn"</span><span class="p">,</span><span class="w"> </span><span class="s2">"mail"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sn"</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<h4 id="returnmappedattributereleasepolicy"><code class="language-plaintext highlighter-rouge">ReturnMappedAttributeReleasePolicy</code></h4>
<p>Similar to above, this policy will return a collection of allowed attributes for the service, but also allows those attributes to be mapped and “renamed” at the more granular service level.</p>

<p>For example, the following configuration will recognize the resolved attributes <code class="language-plaintext highlighter-rouge">eduPersonAffiliation</code> and <code class="language-plaintext highlighter-rouge">groupMembership</code> and will then release affiliation<code class="language-plaintext highlighter-rouge"> and </code>group` to the web application configured.</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.RegexRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"attributeReleasePolicy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.ReturnMappedAttributeReleasePolicy"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"allowedAttributes"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"java.util.TreeMap"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"eduPersonAffiliation"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"affiliation"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"groupMembership"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"group"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<h4 id="attribute-filters">Attribute Filters</h4>
<p>While each policy defines what attributes may be allowed for a given service, there are optional attribute filters that can be set per policy to further weed out attributes based on their <strong>values</strong>.</p>

<h6 id="registeredserviceregexattributefilter"><code class="language-plaintext highlighter-rouge">RegisteredServiceRegexAttributeFilter</code></h6>
<p>The regex filter that is responsible to make sure only attributes whose value matches a certain regex pattern are released.</p>

<p>Suppose that the following attributes are resolved:</p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">uid</code></td>
      <td>jsmith</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">groupMembership</code></td>
      <td>std</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">cn</code></td>
      <td>JohnSmith</td>
    </tr>
  </tbody>
</table>

<p>The following configuration for instance considers the initial list of <code class="language-plaintext highlighter-rouge">uid</code>, <code class="language-plaintext highlighter-rouge">groupMembership</code> and then only allows and releases attributes whose value’s length is 3 characters. Therefor, out of the above list, only <code class="language-plaintext highlighter-rouge">groupMembership</code> is released to the application.</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.RegexRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"attributeReleasePolicy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.ReturnAllowedAttributeReleasePolicy"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"attributeFilter"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.support.RegisteredServiceRegexAttributeFilter"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"pattern"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"^</span><span class="se">\w</span><span class="s2">{3}$"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"allowedAttributes"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"java.util.ArrayList"</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"uid"</span><span class="p">,</span><span class="w"> </span><span class="s2">"groupMembership"</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<h3 id="cachingupdating-attributes">Caching/Updating Attributes</h3>
<p>By default, <a href="Attribute-Resolution.html">resolved attributes</a> are cached to the length of the SSO session. If there are any attribute value changes since the commencement of SSO session, the changes are not reflected and returned back to the service upon release time.</p>

<h4 id="components-1">Components</h4>

<h4 id="principalattributesrepository"><code class="language-plaintext highlighter-rouge">PrincipalAttributesRepository</code></h4>
<p>Parent component that describes the relationship between a CAS <code class="language-plaintext highlighter-rouge">Principal</code> and the underlying attribute repository source.</p>

<h4 id="defaultprincipalattributesrepository"><code class="language-plaintext highlighter-rouge">DefaultPrincipalAttributesRepository</code></h4>
<p>The default relationship between a CAS <code class="language-plaintext highlighter-rouge">Principal</code> and the underlying attribute repository source, such that principal attributes are kept as they are without any additional processes to evaluate and update them. This need not be configured explicitly.</p>

<h4 id="cachingprincipalattributesrepository"><code class="language-plaintext highlighter-rouge">CachingPrincipalAttributesRepository</code></h4>
<p>The  relationship between a CAS <code class="language-plaintext highlighter-rouge">Principal</code> and the underlying attribute repository source, that describes how and
at what length the CAS <code class="language-plaintext highlighter-rouge">Principal</code> attributes should be cached. Upon attribute release time, this component
is consulted to ensure that appropriate attribute values are released to the scoped service, per the cache
expiration policy. If the expiration policy has passed, the underlying attribute repository source will be consulted to figure out the available set of attributes.</p>

<p>The default caching policy is 2 hours.
This component also has the ability to resolve conflicts between existing principal attributes and those that are
retrieved from repository source via a <code class="language-plaintext highlighter-rouge">mergingStrategy</code> property. This is useful if you want to preserve the
collection of attributes that are already available to the principal that were retrieved from a different place
during the authentication event, etc.</p>

<div class="alert alert-info"><strong>Caching Upon Release</strong><p>Note that the policy is only consulted at release time, upon a service ticket validation event. If there are any custom webflows and such that wish to rely on the resolved <code>Principal</code> AND also wish to receive an updated set of attributes, those components must consult the underlying source directory without relying on the <code>Principal</code>.</p></div>

<p>Sample configuration follows:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.RegexRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nl">"attributeReleasePolicy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.ReturnAllowedAttributeReleasePolicy"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"principalAttributesRepository"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.authentication.principal.CachingPrincipalAttributesRepository"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"duration"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"javax.cache.expiry.Duration"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"timeUnit"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"java.util.concurrent.TimeUnit"</span><span class="p">,</span><span class="w"> </span><span class="s2">"HOURS"</span><span class="w"> </span><span class="p">],</span><span class="w">
        </span><span class="nl">"durationAmount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"mergingStrategy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"NONE"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<h4 id="merging-strategies">Merging Strategies</h4>
<p>By default, no merging strategy takes place, which means the principal attributes are always ignored and
attributes from the source are always returned. But any of the following merging strategies may be a suitable option:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">MultivaluedAttributeMerger</code>
Attributes with the same name are merged into multi-valued lists.</li>
</ul>

<p>For example:</p>

<ol>
  <li>Principal has attributes <code class="language-plaintext highlighter-rouge">{email=eric.dalquist@example.com, phone=123-456-7890}</code></li>
  <li>Source has attributes <code class="language-plaintext highlighter-rouge">{phone=[111-222-3333, 000-999-8888], office=3233}</code></li>
  <li>The resulting merged would have attributes: <code class="language-plaintext highlighter-rouge">{email=eric.dalquist@example.com, phone=[123-456-7890, 111-222-3333, 000-999-8888], office=3233}</code></li>
</ol>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.RegexRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nl">"attributeReleasePolicy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.ReturnAllowedAttributeReleasePolicy"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"principalAttributesRepository"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.authentication.principal.CachingPrincipalAttributesRepository"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"duration"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"javax.cache.expiry.Duration"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"timeUnit"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"java.util.concurrent.TimeUnit"</span><span class="p">,</span><span class="w"> </span><span class="s2">"HOURS"</span><span class="w"> </span><span class="p">],</span><span class="w">
        </span><span class="nl">"durationAmount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"mergingStrategy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"MULTIVALUED"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<ul>
  <li><code class="language-plaintext highlighter-rouge">NoncollidingAttributeAdder</code>
Attributes are merged such that attributes from the source that don’t already exist for the principal are produced.</li>
</ul>

<p>For example:</p>

<ol>
  <li>Principal has attributes <code class="language-plaintext highlighter-rouge">{email=eric.dalquist@example.com, phone=123-456-7890}</code></li>
  <li>Source has attributes <code class="language-plaintext highlighter-rouge">{phone=[111-222-3333, 000-999-8888], office=3233}</code></li>
  <li>The resulting merged would have attributes: <code class="language-plaintext highlighter-rouge">{email=eric.dalquist@example.com, phone=123-456-7890, office=3233}</code></li>
</ol>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.RegexRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sample"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nl">"attributeReleasePolicy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.services.ReturnAllowedAttributeReleasePolicy"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"principalAttributesRepository"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.jasig.cas.authentication.principal.CachingPrincipalAttributesRepository"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"duration"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"javax.cache.expiry.Duration"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"timeUnit"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"java.util.concurrent.TimeUnit"</span><span class="p">,</span><span class="w"> </span><span class="s2">"HOURS"</span><span class="w"> </span><span class="p">],</span><span class="w">
        </span><span class="nl">"durationAmount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"mergingStrategy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ADD"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ReplacingAttributeAdder</code>
Attributes are merged such that attributes from the source always replace principal attributes.</li>
</ul>

<p>For example:</p>

<ol>
  <li>Principal has attributes <code class="language-plaintext highlighter-rouge">{email=eric.dalquist@example.com, phone=123-456-7890}</code></li>
  <li>Source has attributes <code class="language-plaintext highlighter-rouge">{phone=[111-222-3333, 000-999-8888], office=3233}</code></li>
  <li>The resulting merged would have attributes: <code class="language-plaintext highlighter-rouge">{email=eric.dalquist@example.com, phone=[111-222-3333, 000-999-8888], office=3233}</code></li>
</ol>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml">{
  "@class" : "org.jasig.cas.services.RegexRegisteredService",
  "serviceId" : "sample",
  "name" : "sample",
  "id" : 100,
  "attributeReleasePolicy" : {
    "@class" : "org.jasig.cas.services.ReturnAllowedAttributeReleasePolicy",
    "principalAttributesRepository" : {
      "@class" : "org.jasig.cas.authentication.principal.CachingPrincipalAttributesRepository",
      "duration" : {
        "@class" : "javax.cache.expiry.Duration",
        "timeUnit" : [ "java.util.concurrent.TimeUnit", "HOURS" ],
        "durationAmount" : 2
      },
      "mergingStrategy" : "REPLACE"
    }
  }
}</code></pre></figure>

<h3 id="encrypting-attributes">Encrypting Attributes</h3>
<p>CAS by default supports the ability to encrypt certain attributes, such as the proxy-granting ticket and the credential conditionally.
If you wish to take this a step further and encrypt other attributes that you deem sensitive, you can use the following components
as a baseline to carry out the task at hand:</p>

<p><code class="language-plaintext highlighter-rouge">DefaultCasAttributeEncoder</code>
The default implementation of the attribute encoder that will use a per-service key-pair
to encrypt. It will attempt to query the collection of attributes that resolved to determine
which attributes can be encoded. Attributes will be encoded via a <code class="language-plaintext highlighter-rouge">RegisteredServiceCipherExecutor</code>.</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"cas3ServiceSuccessView"</span>
    <span class="na">class=</span><span class="s">"org.jasig.cas.web.view.Cas30ResponseView"</span>
    <span class="na">c:view-ref=</span><span class="s">"cas3JstlSuccessView"</span>
    <span class="na">p:successResponse=</span><span class="s">"true"</span>
    <span class="na">p:servicesManager-ref=</span><span class="s">"servicesManager"</span>
    <span class="na">p:casAttributeEncoder-ref=</span><span class="s">"casAttributeEncoder"</span>  <span class="nt">/&gt;</span>

<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"casRegisteredServiceCipherExecutor"</span>
    <span class="na">class=</span><span class="s">"org.jasig.cas.services.DefaultRegisteredServiceCipherExecutor"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"casAttributeEncoder"</span>
    <span class="na">class=</span><span class="s">"org.jasig.cas.authentication.support.DefaultCasAttributeEncoder"</span>
    <span class="na">c:servicesManager-ref=</span><span class="s">"servicesManager"</span>
    <span class="na">c:cipherExecutor-ref=</span><span class="s">"casRegisteredServiceCipherExecutor"</span>  <span class="nt">/&gt;</span></code></pre></figure>


                </div>
            </section>
        </main>
    </div>
</div>


<footer>
    <div class="container">
        CAS is supported by the <a href="https://www.apereo.org/">Apereo Foundation</a>.
    </div>
</footer>

<script>
    let pageSection = '';
</script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.2/js/tether.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script>

<script src="../../javascripts/URI.js"></script>
<script src="../../javascripts/main.js"></script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
</body>

</html>
