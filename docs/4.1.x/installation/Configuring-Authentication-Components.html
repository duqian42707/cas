<!DOCTYPE html>
<html>

<head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="CAS - Enterprise Single Sign-On for the Web"/>
    <meta name="keywords" content="authentication, login, cas, central authentication service, web, java, protocol, thymeleaf,
                   open source, boot, spring, authorization, google, facebook, twitter, higher-ed, enterprise,
                   access management, single signon, sso, RBAC, ABAC, attributes, SAML, OpenID, openid connect,
                   JWT, ADFS"/>
    <meta name="robots" content="index,follow"/>

    
    

        
    


    

    <script>
        ((i, s, o, g, r, a, m) => {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-83384532-2', 'auto');
        ga('send', 'pageview');

    </script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/>

    <link rel="stylesheet" type="text/css" media="screen" href="../../stylesheets/stylesheet.css">
    <link rel="stylesheet" type="text/css" media="print" href="../../stylesheets/print.css">

    <link href='https://fonts.googleapis.com/css?family=Lato:400,300,700' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic&subset=latin-ext,latin' rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" rel="stylesheet">

    <title>CAS - Configuring Authentication Components</title>

</head>

<body>
<!-- HEADER -->
<header class="hidden-sm-down">
    <div class="container">
        <div class="row">
            <div class="col-xs-4 col-md-2">
                <a href="../../index.html">
                    <img class="undecorated" src="../../images/cas_logo.png"/>
                </a>
            </div>
            <div class="col-xs-8 col-md-6">
                <h1>Enterprise Single Sign-On for All</h1>
            </div>
            <div class="hidden-sm-down col-md-4">
                <a id="forkme_banner" href="https://github.com/apereo/cas">View on GitHub</a>
            </div>

        </div>
    </div>
</header>

<!-- NAVBAR -->

<nav class="navbar navbar-expand-md navbar-dark bg-primary bg-dark">
    <div class="container">
        <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="navbar-collapse collapse" id="navbarsExample04">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active"><a href="../../index.html" class="zoom nav-link">Home</a></li>
                <li class="nav-item"><a href="https://github.com/apereo/cas/releases" class="zoom nav-link">Releases</a></li>
                <li class="nav-item"><a href="../../Support.html" class="zoom nav-link">Support</a></li>
                <li class="nav-item"><a href="../../Mailing-Lists.html" class="zoom nav-link">Mailing Lists</a></li>
                <li class="nav-item">
                    <a class="zoom nav-link" href="../../Demos.html">Demos</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="zoom nav-link dropdown-toggle mr-md-2" href="#" id="cas-versions" data-bs-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">Versions</a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="cas-versions">
                        
                        
                        <a class="dropdown-item" href="/cas/development/">Development</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.6.x/">v6.6.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.5.x/">v6.5.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.4.x/">v6.4.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.3.x/">v6.3.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.2.x/">v6.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.1.x/">v6.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.0.x/">v6.0.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.3.x/">v5.3.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.2.x/">v5.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.1.x/">v5.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.0.x/">v5.0.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.2.x/">v4.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.1.x/">v4.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.0.x/">v4.0.x</a>
                        
                        

                    </div>
                </li>
                <li class="nav-item"><a href="https://apereo.github.io" target="_blank" class="zoom nav-link">Blog</a></li>
            </ul>

        </div>

    </div>
</nav>


<div class="container-fluid">
    <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 docs-sidebar pb-5" id="sidebar"></div>


        <div class="d-none d-xl-block col-xl-2 docs-toc">
    <div id="pageContents">
        <ul class="section-nav"></ul>
    </div>
</div>


        <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 cas-docs-content" role="main">


            

            <section>
                <nav id="docsNavBar">
                    <span id="toolbarIcons"></span>
                </nav>

                <div id="cas-docs-container">
                    <h1 id="authentication">Authentication</h1>
<p>The CAS authentication process is performed by several related components:</p>

<h6 id="principalnametransformer"><code class="language-plaintext highlighter-rouge">PrincipalNameTransformer</code></h6>
<p>Transforms the user id string that is typed into the login form into a tentative Principal Name to be
validated by a specific type of Authentication Handler.</p>

<h6 id="authenticationmanager"><code class="language-plaintext highlighter-rouge">AuthenticationManager</code></h6>
<p>Entry point into authentication subsystem. It accepts one or more credentials and delegates authentication to
configured <code class="language-plaintext highlighter-rouge">AuthenticationHandler</code> components. It collects the results of each attempt and determines effective
security policy.</p>

<h6 id="authenticationhandler"><code class="language-plaintext highlighter-rouge">AuthenticationHandler</code></h6>
<p>Authenticates a single credential and reports one of three possible results: success, failure, not attempted.</p>

<h6 id="principalresolver"><code class="language-plaintext highlighter-rouge">PrincipalResolver</code></h6>
<p>Converts information in the authentication credential into a security principal that commonly contains additional
metadata attributes (i.e. user details such as affiliations, group membership, email, display name).</p>

<h6 id="authenticationmetadatapopulator"><code class="language-plaintext highlighter-rouge">AuthenticationMetaDataPopulator</code></h6>
<p>Strategy component for setting arbitrary metadata about a successful authentication event; these are commonly used
to set protocol-specific data.</p>

<p>Unless otherwise noted, the configuration for all authentication components is handled in <code class="language-plaintext highlighter-rouge">deployerConfigContext.xml</code>.</p>

<h2 id="authentication-manager">Authentication Manager</h2>
<p>CAS ships with a single yet flexible authentication manager, <code class="language-plaintext highlighter-rouge">PolicyBasedAuthenticationManager</code>, that should be
sufficient for most needs. It performs authentication according to the following contract.</p>

<p>For each given credential do the following:</p>

<ol>
  <li>Iterate over all configured authentication handlers.</li>
  <li>Attempt to authenticate a credential if a handler supports it.</li>
  <li>On success attempt to resolve a principal.</li>
  <li>Check whether a resolver is configured for the handler that authenticated the credential.</li>
  <li>If a suitable resolver is found, attempt to resolve the principal.</li>
  <li>If a suitable resolver is not found, use the principal resolved by the authentication handler.</li>
  <li>Check whether the security policy (e.g. any, all) is satisfied.</li>
  <li>If security policy is met return immediately.</li>
  <li>Continue if security policy is not met.</li>
  <li>After all credentials have been attempted check security policy again and throw <code class="language-plaintext highlighter-rouge">AuthenticationException</code>
if not satisfied.</li>
</ol>

<p>There is an implicit security policy that requires at least one handler to successfully authenticate a credential,
but the behavior can be further controlled by setting <code class="language-plaintext highlighter-rouge">#setAuthenticationPolicy(AuthenticationPolicy)</code>
with one of the following policies.</p>

<h6 id="anyauthenticationpolicy"><code class="language-plaintext highlighter-rouge">AnyAuthenticationPolicy</code></h6>
<p>Satisfied if any handler succeeds. Supports a <code class="language-plaintext highlighter-rouge">tryAll</code> flag to avoid short circuiting at step 4.1 above and try every
handler even if one prior succeeded. This policy is the default and provides backward-compatible behavior with the
<code class="language-plaintext highlighter-rouge">AuthenticationManagerImpl</code> component of CAS 3.x.</p>

<h6 id="allauthenticationpolicy"><code class="language-plaintext highlighter-rouge">AllAuthenticationPolicy</code></h6>
<p>Satisfied if and only if all given credentials are successfully authenticated. Support for multiple credentials is
new in CAS and this handler would only be acceptable in a multi-factor authentication situation.</p>

<h6 id="requiredhandlerauthenticationpolicy"><code class="language-plaintext highlighter-rouge">RequiredHandlerAuthenticationPolicy</code></h6>
<p>Satisfied if an only if a specified handler successfully authenticates its credential. Supports a <code class="language-plaintext highlighter-rouge">tryAll</code> flag to
avoid short circuiting at step 4.1 above and try every handler even if one prior succeeded. This policy could be
used to support a multi-factor authentication situation, for example, where username/password authentication is
required but an additional OTP is optional.</p>

<p>The following configuration snippet demonstrates how to configure <code class="language-plaintext highlighter-rouge">PolicyBasedAuthenticationManager</code> for a
straightforward multi-factor authentication case where username/password authentication is required 
and an additional OTP credential is optional; in both cases principals are resolved from LDAP.</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"passwordHandler"</span>
      <span class="na">class=</span><span class="s">"org.jasig.cas.authentication.LdapAuthenticationHandler"</span><span class="nt">&gt;</span>
      <span class="c">&lt;!-- Details elided for simplicity --&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"oneTimePasswordHandler"</span>
      <span class="na">class=</span><span class="s">"com.example.cas.authentication.CustomOTPAuthenticationHandler"</span>
      <span class="na">p:name=</span><span class="s">"oneTimePasswordHandler"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"authenticationPolicy"</span>
      <span class="na">class=</span><span class="s">"org.jasig.cas.authentication.RequiredHandlerAuthenticationPolicyFactory"</span>
      <span class="na">c:requiredHandlerName=</span><span class="s">"passwordHandler"</span>
      <span class="na">p:tryAll=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
      

<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"principalResolver"</span>
      <span class="na">class=</span><span class="s">"org.jasig.cas.authentication.principal.PersonDirectoryPrincipalResolver"</span>
      <span class="na">p:principalAttributeName=</span><span class="s">"username"</span>
      <span class="na">p:attributeRepository-ref=</span><span class="s">"attributeRepository"</span>
      <span class="na">p:returnNullIfNoAttributes=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
      
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"authenticationManager"</span>
      <span class="na">class=</span><span class="s">"org.jasig.cas.authentication.PolicyBasedAuthenticationManager"</span>
      <span class="na">p:authenticationPolicy-ref=</span><span class="s">"authenticationPolicy"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;constructor-arg&gt;</span>
    <span class="nt">&lt;map&gt;</span>
      <span class="nt">&lt;entry</span> <span class="na">key-ref=</span><span class="s">"passwordHandler"</span> <span class="na">value-ref=</span><span class="s">"principalResolver"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;entry</span> <span class="na">key-ref=</span><span class="s">"oneTimePasswordHandler"</span> <span class="na">value-ref=</span><span class="s">"principalResolver"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/map&gt;</span>
  <span class="nt">&lt;/constructor-arg&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"authenticationMetaDataPopulators"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;list&gt;</span>
      <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.jasig.cas.authentication.SuccessfulHandlerMetaDataPopulator"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/list&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span></code></pre></figure>

<h2 id="authentication-handlers">Authentication Handlers</h2>
<p>CAS ships with support for authenticating against many common kinds of authentication systems.
The following list provides a complete list of supported authentication technologies; jump to the section(s) of
interest.</p>

<ul>
  <li><a href="Database-Authentication.html">Database</a></li>
  <li><a href="JAAS-Authentication.html">JAAS</a></li>
  <li><a href="LDAP-Authentication.html">LDAP</a></li>
  <li><a href="Legacy-Authentication.html">Legacy</a></li>
  <li><a href="OAuth-OpenId-Authentication.html">OAuth 1.0/2.0, OpenID</a></li>
  <li><a href="RADIUS-Authentication.html">RADIUS</a></li>
  <li><a href="SPNEGO-Authentication.html">SPNEGO</a> (Windows)</li>
  <li><a href="Trusted-Authentication.html">Trusted</a> (REMOTE_USER)</li>
  <li><a href="X509-Authentication.html">X.509</a> (client SSL certificate)</li>
  <li><a href="Remote-Address-Authentication.html">Remote Address</a></li>
</ul>

<p>There are some additional handlers for small deployments and special cases:</p>

<ul>
  <li><a href="Whitelist-Authentication.html">Whilelist</a></li>
  <li><a href="Blacklist-Authentication.html">Blacklist</a></li>
</ul>

<h2 id="argument-extractors">Argument Extractors</h2>
<p>Extractors are responsible to examine the http request received for parameters that describe the authentication request such as the requesting <code class="language-plaintext highlighter-rouge">service</code>, etc. Extractors exist for a number of supported authentication protocols and each create appropriate instances of <code class="language-plaintext highlighter-rouge">WebApplicationService</code> that contains the results of the extraction.</p>

<p>Argument extractor configuration is defined at <code class="language-plaintext highlighter-rouge">src/main/webapp/WEB-INF/spring-configuration/argumentExtractorsConfiguration.xml</code>. Here’s a brief sample:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"casArgumentExtractor"</span>	<span class="na">class=</span><span class="s">"org.jasig.cas.web.support.CasArgumentExtractor"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;util:list</span> <span class="na">id=</span><span class="s">"argumentExtractors"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ref</span> <span class="na">bean=</span><span class="s">"casArgumentExtractor"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/util:list&gt;</span></code></pre></figure>

<h3 id="components">Components</h3>

<h4 id="argumentextractor"><code class="language-plaintext highlighter-rouge">ArgumentExtractor</code></h4>
<p>Strategy parent interface that defines operations needed to extract arguments from the http request.</p>

<h4 id="casargumentextractor"><code class="language-plaintext highlighter-rouge">CasArgumentExtractor</code></h4>
<p>Argument extractor that maps the request based on the specifications of the CAS protocol.</p>

<h4 id="googleaccountsargumentextractor"><code class="language-plaintext highlighter-rouge">GoogleAccountsArgumentExtractor</code></h4>
<p>Argument extractor to be used to enable Google Apps integration and SAML v2 specification.</p>

<h4 id="samlargumentextractor"><code class="language-plaintext highlighter-rouge">SamlArgumentExtractor</code></h4>
<p>Argument extractor compliant with SAML v1.1 specification.</p>

<h4 id="openidargumentextractor"><code class="language-plaintext highlighter-rouge">OpenIdArgumentExtractor</code></h4>
<p>Argument extractor compliant with OpenId protocol.</p>

<h2 id="principal-resolution">Principal Resolution</h2>
<p>Please <a href="Configuring-Principal-Resolution.html">see this guide</a> more full details on principal resolution.</p>

<h3 id="principalnametransformer-components">PrincipalNameTransformer Components</h3>
<p>Authentication handlers that generally deal with username-password credentials
can be configured to transform the user id prior to executing the authentication sequence. The following components are available:</p>

<h6 id="noopprincipalnametransformer"><code class="language-plaintext highlighter-rouge">NoOpPrincipalNameTransformer</code></h6>
<p>Default transformer, that actually does no transformation on the user id.</p>

<h6 id="prefixsuffixprincipalnametransformer"><code class="language-plaintext highlighter-rouge">PrefixSuffixPrincipalNameTransformer</code></h6>
<p>Transforms the user id by adding a postfix or suffix.</p>

<h6 id="convertcaseprincipalnametransformer"><code class="language-plaintext highlighter-rouge">ConvertCasePrincipalNameTransformer</code></h6>
<p>A transformer that converts the form uid to either lowercase or uppercase. The result is also trimmed.
The transformer is also able to accept and work on the result of 
a previous transformer that might have modified the uid, such that the two can be chained.</p>

<h4 id="configuration">Configuration</h4>
<p>Here is an example configuration based for the <code class="language-plaintext highlighter-rouge">AcceptUsersAuthenticationHandler</code>:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"primaryAuthenticationHandler"</span>
    <span class="na">class=</span><span class="s">"org.jasig.cas.authentication.AcceptUsersAuthenticationHandler"</span>
    <span class="na">p:principalNameTransformer-ref=</span><span class="s">"convertCasePrincipalNameTransformer"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"users"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;map&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">"casuser"</span> <span class="na">value=</span><span class="s">"Mellon"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/map&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"convertCasePrincipalNameTransformer"</span> 
    <span class="na">class=</span><span class="s">"org.jasig.cas.authentication.handler.ConvertCasePrincipalNameTransformer"</span>
    <span class="na">p:toUpperCase=</span><span class="s">"true"</span> <span class="nt">/&gt;</span></code></pre></figure>

<h2 id="authentication-metadata">Authentication Metadata</h2>
<p><code class="language-plaintext highlighter-rouge">AuthenticationMetaDataPopulator</code> components provide a pluggable strategy for injecting arbitrary metadata into the
authentication subsystem for consumption by other subsystems or external components. Some notable uses of metadata
populators:</p>

<ul>
  <li>Supports the long term authentication feature</li>
  <li>SAML protocol support</li>
  <li>OAuth and OpenID protocol support.</li>
</ul>

<p>The default authentication metadata populators should be sufficient for most deployments. Where the components are
required to support optional CAS features, they will be explicitly identified and configuration will be provided.</p>

<h2 id="long-term-authentication">Long Term Authentication</h2>
<p>CAS has support for long term Ticket Granting Tickets, a feature that is also referred to as <em>“Remember Me”</em>
to extends the length of the SSO session beyond the typical configuration.
Please <a href="Configuring-LongTerm-Authentication.html">see this guide</a> for more details.</p>

<h2 id="proxy-authentication">Proxy Authentication</h2>
<p>Please <a href="Configuring-Proxy-Authentication.html">see this guide</a> for more details.</p>

<h2 id="multi-factor-authentication-mfa">Multi-factor Authentication (MFA)</h2>
<p>Please <a href="Configuring-Multifactor-Authentication.html">see this guide</a> for more details.</p>

<h2 id="login-throttling">Login Throttling</h2>
<p>CAS provides a facility for limiting failed login attempts to support password guessing and related abuse scenarios.
Please <a href="Configuring-Authentication-Throttling.html">see this guide</a> for additional details on login throttling.</p>

<h2 id="sso-session-cookie">SSO Session Cookie</h2>
<p>A ticket-granting cookie is an HTTP cookie set by CAS upon the establishment of a single sign-on session. 
This cookie maintains login state for the client, and while it is valid, the client can present it to CAS in lieu of primary credentials.
Please <a href="Configuring-SSO-Session-Cookie.html">see this guide</a> for additional details.</p>

                </div>
            </section>
        </main>
    </div>
</div>


<footer>
    <div class="container">
        CAS is supported by the <a href="https://www.apereo.org/">Apereo Foundation</a>.
    </div>
</footer>

<script>
    let pageSection = '';
</script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.2/js/tether.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script>

<script src="../../javascripts/URI.js"></script>
<script src="../../javascripts/main.js"></script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
</body>

</html>
