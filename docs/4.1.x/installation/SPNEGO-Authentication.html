<!DOCTYPE html>
<html>

<head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="CAS - Enterprise Single Sign-On for the Web"/>
    <meta name="keywords" content="authentication, login, cas, central authentication service, web, java, protocol, thymeleaf,
                   open source, boot, spring, authorization, google, facebook, twitter, higher-ed, enterprise,
                   access management, single signon, sso, RBAC, ABAC, attributes, SAML, OpenID, openid connect,
                   JWT, ADFS"/>
    <meta name="robots" content="index,follow"/>

    
    

        
    


    

    <script>
        ((i, s, o, g, r, a, m) => {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-83384532-2', 'auto');
        ga('send', 'pageview');

    </script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/>

    <link rel="stylesheet" type="text/css" media="screen" href="../../stylesheets/stylesheet.css">
    <link rel="stylesheet" type="text/css" media="print" href="../../stylesheets/print.css">

    <link href='https://fonts.googleapis.com/css?family=Lato:400,300,700' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic&subset=latin-ext,latin' rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" rel="stylesheet">

    <title>CAS - SPNEGO Authentication</title>

</head>

<body>
<!-- HEADER -->
<header class="hidden-sm-down">
    <div class="container">
        <div class="row">
            <div class="col-xs-4 col-md-2">
                <a href="../../index.html">
                    <img class="undecorated" src="../../images/cas_logo.png"/>
                </a>
            </div>
            <div class="col-xs-8 col-md-6">
                <h1>Enterprise Single Sign-On for All</h1>
            </div>
            <div class="hidden-sm-down col-md-4">
                <a id="forkme_banner" href="https://github.com/apereo/cas">View on GitHub</a>
            </div>

        </div>
    </div>
</header>

<!-- NAVBAR -->

<nav class="navbar navbar-expand-md navbar-dark bg-primary bg-dark">
    <div class="container">
        <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="navbar-collapse collapse" id="navbarsExample04">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active"><a href="../../index.html" class="zoom nav-link">Home</a></li>
                <li class="nav-item"><a href="https://github.com/apereo/cas/releases" class="zoom nav-link">Releases</a></li>
                <li class="nav-item"><a href="../../Support.html" class="zoom nav-link">Support</a></li>
                <li class="nav-item"><a href="../../Mailing-Lists.html" class="zoom nav-link">Mailing Lists</a></li>
                <li class="nav-item">
                    <a class="zoom nav-link" href="../../Demos.html">Demos</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="zoom nav-link dropdown-toggle mr-md-2" href="#" id="cas-versions" data-bs-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">Versions</a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="cas-versions">
                        
                        
                        <a class="dropdown-item" href="/cas/development/">Development</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.6.x/">v6.6.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.5.x/">v6.5.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.4.x/">v6.4.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.3.x/">v6.3.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.2.x/">v6.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.1.x/">v6.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.0.x/">v6.0.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.3.x/">v5.3.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.2.x/">v5.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.1.x/">v5.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.0.x/">v5.0.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.2.x/">v4.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.1.x/">v4.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.0.x/">v4.0.x</a>
                        
                        

                    </div>
                </li>
                <li class="nav-item"><a href="https://apereo.github.io" target="_blank" class="zoom nav-link">Blog</a></li>
            </ul>

        </div>

    </div>
</nav>


<div class="container-fluid">
    <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 docs-sidebar pb-5" id="sidebar"></div>


        <div class="d-none d-xl-block col-xl-2 docs-toc">
    <div id="pageContents">
        <ul class="section-nav"></ul>
    </div>
</div>


        <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 cas-docs-content" role="main">


            

            <section>
                <nav id="docsNavBar">
                    <span id="toolbarIcons"></span>
                </nav>

                <div id="cas-docs-container">
                    <h1 id="spnego-authentication">SPNEGO Authentication</h1>
<p><a href="http://en.wikipedia.org/wiki/SPNEGO">SPNEGO</a> is an authentication technology that is primarily used to provide
transparent CAS authentication to browsers running on Windows running under Active Directory domain credentials.
There are three actors involved: the client, the CAS server, and the Active Directory Domain Controller/KDC.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>1. Client sends CAS:               HTTP GET to CAS  for cas protected page
2. CAS responds:                   HTTP 401 - Access Denied WWW-Authenticate: Negotiate
3. Client sends ticket request:    Kerberos(KRB_TGS_REQ) Requesting ticket for HTTP/cas.example.com@REALM
4. Kerberos KDC responds:          Kerberos(KRB_TGS_REP) Granting ticket for HTTP/cas.example.com@REALM
5. Client sends CAS:               HTTP GET Authorization: Negotiate w/SPNEGO Token
6. CAS responds:                   HTTP 200 - OK WWW-Authenticate w/SPNEGO response + requested page.
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The above interaction occurs only for the first request, when there is no CAS ticket-granting ticket associated with
the user session. Once CAS grants a ticket-granting ticket, the SPNEGO process will not happen again until the CAS
ticket expires.</p>

<h2 id="spnego-requirements">SPNEGO Requirements</h2>
<ul>
  <li>Client is logged in to a Windows Active Directory domain.</li>
  <li>Supported browser and JDK.</li>
  <li>CAS is running MIT kerberos against the AD domain controller.</li>
</ul>

<h2 id="spnego-components">SPNEGO Components</h2>
<p>SPNEGO support is enabled by including the following dependency in the Maven WAR overlay:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.jasig.cas<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>cas-server-support-spnego<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>${cas.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></figure>

<h6 id="jcifsspnegoauthenticationhandler"><code class="language-plaintext highlighter-rouge">JCIFSSpnegoAuthenticationHandler</code></h6>
<p>The authentication handler that provides SPNEGO support in both Kerberos and NTLM flavors. NTLM is disabled by default.
Configuration properties:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">principalWithDomainName</code> - True to include the domain name in the CAS principal ID, false otherwise.</li>
  <li><code class="language-plaintext highlighter-rouge">NTLMallowed</code> - True to enable NTLM support, false otherwise. (Disabled by default.)</li>
</ul>

<h6 id="jcifsconfig"><code class="language-plaintext highlighter-rouge">JCIFSConfig</code></h6>
<p>Configuration helper for JCIFS and the Spring framework. Configuration properties:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">jcifsServicePrincipal</code> - service principal name.</li>
  <li><code class="language-plaintext highlighter-rouge">jcifsServicePassword</code> - service principal password.</li>
  <li><code class="language-plaintext highlighter-rouge">kerberosDebug</code> - True to enable kerberos debugging, false otherwise.</li>
  <li><code class="language-plaintext highlighter-rouge">kerberosRealm</code> - Kerberos realm name.</li>
  <li><code class="language-plaintext highlighter-rouge">kerberosKdc</code> - Kerberos KDC address.</li>
  <li><code class="language-plaintext highlighter-rouge">loginConf</code> - Path to the login.conf JAAS configuration file.</li>
</ul>

<h6 id="spnegonegociatecredentialsaction"><code class="language-plaintext highlighter-rouge">SpnegoNegociateCredentialsAction</code></h6>
<p>CAS login Webflow action that begins the SPNEGO authenticaiton process. The action checks the <code class="language-plaintext highlighter-rouge">Authorization</code> request
header for a suitable value (<code class="language-plaintext highlighter-rouge">Negotiate</code> for Kerberos or <code class="language-plaintext highlighter-rouge">NTLM</code>). If the check is successful, flow continues to the
<code class="language-plaintext highlighter-rouge">SpnegoCredentialsAction</code> state; otherwise a 401 (not authorized) response is returned.</p>

<h6 id="spnegocredentialsaction"><code class="language-plaintext highlighter-rouge">SpnegoCredentialsAction</code></h6>
<p>Constructs CAS credentials from the encoded GSSAPI data in the <code class="language-plaintext highlighter-rouge">Authorization</code> request header. The standard CAS
authentication process proceeds as usual after this step: authentication is attempted with a suitable handler,
<code class="language-plaintext highlighter-rouge">JCIFSSpnegoAuthenticationHandler</code> in this case. The action also sets response headers accordingly based on whether
authentication succeeded or failed.</p>

<h2 id="spnego-configuration">SPNEGO Configuration</h2>

<h3 id="create-spn-account">Create SPN Account</h3>
<p>Create an Active Directory account for the Service Principal Name (SPN) and record the username and password, which
will be used subsequently to configure the <code class="language-plaintext highlighter-rouge">JCIFSConfig</code> component.</p>

<h3 id="create-keytab-file">Create Keytab File</h3>
<p>The keytab file enables a trust link between the CAS server and the Key Distribution Center (KDC); an Active Directory
domain controller serves the role of KDC in this context.
The <a href="http://technet.microsoft.com/en-us/library/cc753771.aspx"><code class="language-plaintext highlighter-rouge">ktpass</code> tool</a> is used to generate the keytab file,
which contains a cryptographic key. Be sure to execute the command from an Active Directory domain controller as
administrator.</p>

<h3 id="test-spn-account">Test SPN Account</h3>
<p>Install and configure MIT Kerberos V on the CAS server host(s). The following sample <code class="language-plaintext highlighter-rouge">krb5.conf</code> file may be used
as a reference.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>[logging]
 default = FILE:/var/log/krb5libs.log
 kdc = FILE:/var/log/krb5kdc.log
 admin_server = FILE:/var/log/kadmind.log
 
[libdefaults]
 ticket_lifetime = 24000
 default_realm = YOUR.REALM.HERE
 default_keytab_name = /home/cas/kerberos/myspnaccount.keytab
 dns_lookup_realm = false
 dns_lookup_kdc = false
 default_tkt_enctypes = rc4-hmac
 default_tgs_enctypes = rc4-hmac
 
[realms]
 YOUR.REALM.HERE = {
  kdc = your.kdc.your.realm.here:88
 }
 
[domain_realm]
 .your.realm.here = YOUR.REALM.HERE
 your.realm.here = YOUR.REALM.HERE
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Then verify that your are able to read the keytab file:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>klist -k
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Then verify that your are able to read the keytab file:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>kinit a_user_in_the_realm@YOUR.REALM.HERE
klist
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="browser-configuration">Browser Configuration</h3>
<ul>
  <li>Internet Explorer - Enable <em>Integrated Windows Authentication</em> and add the CAS server URL to the <em>Local Intranet</em>
zone.</li>
  <li>Firefox - Set the <code class="language-plaintext highlighter-rouge">network.negotiate-auth.trusted-uris</code> configuration parameter in <code class="language-plaintext highlighter-rouge">about:config</code> to the CAS server
URL, e.g. https://cas.example.com.</li>
</ul>

<h3 id="cas-component-configuration">CAS Component Configuration</h3>
<p>Define two new action states in <code class="language-plaintext highlighter-rouge">login-webflow.xml</code> before the <code class="language-plaintext highlighter-rouge">viewLoginForm</code> state:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;action-state</span> <span class="na">id=</span><span class="s">"startAuthenticate"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;evaluate</span> <span class="na">expression=</span><span class="s">"negociateSpnego"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;transition</span> <span class="na">on=</span><span class="s">"success"</span> <span class="na">to=</span><span class="s">"spnego"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/action-state&gt;</span>
 
<span class="nt">&lt;action-state</span> <span class="na">id=</span><span class="s">"spnego"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;evaluate</span> <span class="na">expression=</span><span class="s">"spnego"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;transition</span> <span class="na">on=</span><span class="s">"success"</span> <span class="na">to=</span><span class="s">"sendTicketGrantingTicket"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;transition</span> <span class="na">on=</span><span class="s">"error"</span> <span class="na">to=</span><span class="s">"viewLoginForm"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/action-state&gt;</span></code></pre></figure>

<p>Additionally, find action <code class="language-plaintext highlighter-rouge">generateLoginTicket</code> - replace <code class="language-plaintext highlighter-rouge">viewLoginForm</code> with <code class="language-plaintext highlighter-rouge">startAuthenticate</code>.</p>

<p>Add two bean definitions in <code class="language-plaintext highlighter-rouge">cas-servlet.xml</code>:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"negociateSpnego"</span> <span class="na">class=</span><span class="s">"org.jasig.cas.support.spnego.web.flow.SpnegoNegociateCredentialsAction"</span> <span class="nt">/&gt;</span>
 
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"spnego"</span> <span class="na">class=</span><span class="s">"org.jasig.cas.support.spnego.web.flow.SpnegoCredentialsAction"</span>
      <span class="na">p:centralAuthenticationService-ref=</span><span class="s">"centralAuthenticationService"</span> <span class="nt">/&gt;</span></code></pre></figure>

<p>Update <code class="language-plaintext highlighter-rouge">deployerConfigContext.xml</code> according to the following template:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"jcifsConfig"</span>
      <span class="na">class=</span><span class="s">"org.jasig.cas.support.spnego.authentication.handler.support.JCIFSConfig"</span>
      <span class="na">p:jcifsServicePrincipal=</span><span class="s">"HTTP/cas.example.com@EXAMPLE.COM"</span>
      <span class="na">p:kerberosDebug=</span><span class="s">"false"</span>
      <span class="na">p:kerberosRealm=</span><span class="s">"EXAMPLE.COM"</span>
      <span class="na">p:kerberosKdc=</span><span class="s">"172.10.1.10"</span>
      <span class="na">p:loginConf=</span><span class="s">"/path/to/login.conf"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"spnegoAuthentication"</span> <span class="na">class=</span><span class="s">"jcifs.spnego.Authentication"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"spnegoHandler"</span>
      <span class="na">class=</span><span class="s">"org.jasig.cas.support.spnego.authentication.handler.support.JCIFSSpnegoAuthenticationHandler"</span>
      <span class="na">p:authentication-ref=</span><span class="s">"spnegoAuthentication"</span>
      <span class="na">p:principalWithDomainName=</span><span class="s">"false"</span>
      <span class="na">p:NTLMallowed=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"spnegoPrincipalResolver"</span>
      <span class="na">class=</span><span class="s">"org.jasig.cas.support.spnego.authentication.principal.SpnegoPrincipalResolver"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"authenticationManager"</span>
      <span class="na">class=</span><span class="s">"org.jasig.cas.authentication.PolicyBasedAuthenticationManager"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;constructor-arg&gt;</span>
    <span class="nt">&lt;map&gt;</span>
      <span class="nt">&lt;entry</span> <span class="na">key-ref=</span><span class="s">"spnegoHandler"</span> <span class="na">value-ref=</span><span class="s">"spnegoPrincipalResolver"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/map&gt;</span>
  <span class="nt">&lt;/constructor-arg&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"authenticationMetaDataPopulators"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;list&gt;</span>
      <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.jasig.cas.authentication.SuccessfulHandlerMetaDataPopulator"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/list&gt;</span>
  <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span></code></pre></figure>

<p>Provide a JAAS <code class="language-plaintext highlighter-rouge">login.conf</code> file in a location that agrees with the <code class="language-plaintext highlighter-rouge">loginConf</code> property of the <code class="language-plaintext highlighter-rouge">JCIFSConfig</code> bean
above.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>jcifs.spnego.initiate {
   com.sun.security.auth.module.Krb5LoginModule required storeKey=true useKeyTab=true keyTab="/home/cas/kerberos/myspnaccount.keytab";
};
jcifs.spnego.accept {
   com.sun.security.auth.module.Krb5LoginModule required storeKey=true useKeyTab=true keyTab="/home/cas/kerberos/myspnaccount.keytab";
};
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="client-selection-strategy">Client Selection Strategy</h2>
<p>CAS provides a set of components that attempt to activate the SPNEGO flow conditionally, in case deployers need a configurable way to decide whether SPNEGO should be applied to the current authentication/browser request. The components provided are webflow actions that return either <code class="language-plaintext highlighter-rouge">yes</code> or <code class="language-plaintext highlighter-rouge">no</code> to the webflow and allow you to reroute the webflow conditionally based the outcome, to either SPNEGO or the normal CAS login flow.</p>

<p>The activation strategies are as follows:</p>

<h3 id="by-remote-ip">By Remote IP</h3>
<p>Checks to see if the request’s remote ip address matches a predefine pattern.</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"baseSpnegoClientAction"</span> 
      <span class="na">class=</span><span class="s">"org.jasig.cas.support.spnego.web.flow.client.BaseSpnegoKnownClientSystemsFilterAction"</span>
      <span class="na">c:ipsToCheckPattern=</span><span class="s">"127.+"</span>
      <span class="na">c:alternativeRemoteHostAttribute=</span><span class="s">"alternateRemoteHeader"</span> <span class="nt">/&gt;</span></code></pre></figure>

<h3 id="by-hostname">By Hostname</h3>
<p>Checks to see if the request’s remote hostname matches a predefine pattern. This action supports all functionality provided by <code class="language-plaintext highlighter-rouge">BaseSpnegoKnownClientSystemsFilterAction</code>.</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"hostnameSpnegoClientAction"</span> 
      <span class="na">class=</span><span class="s">"org.jasig.cas.support.spnego.web.flow.client.HostNameSpnegoKnownClientSystemsFilterAction"</span>
      <span class="na">c:hostNamePatternString=</span><span class="s">"something.+"</span> <span class="nt">/&gt;</span></code></pre></figure>

<h3 id="by-ldap-attribute">By LDAP Attribute</h3>
<p>Checks an LDAP instance for the remote hostname, to locate a pre-defined attribute whose mere existence would allow the webflow to resume to SPNEGO. This action supports all functionality provided by <code class="language-plaintext highlighter-rouge">BaseSpnegoKnownClientSystemsFilterAction</code>.</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"ldapSpnegoClientAction"</span> 
      <span class="na">class=</span><span class="s">"org.jasig.cas.support.spnego.web.flow.client.LdapSpnegoKnownClientSystemsFilterAction"</span>
      <span class="na">c:connectionFactory-ref=</span><span class="s">"connectionFactory"</span>
      <span class="na">c:searchRequest-ref=</span><span class="s">"searchRequest"</span>
      <span class="na">c:spnegoAttributeName=</span><span class="s">"spnegoAttribute"</span> <span class="nt">/&gt;</span></code></pre></figure>

<p>Sample search request and filer:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"searchRequest"</span> <span class="na">class=</span><span class="s">"org.ldaptive.SearchRequest"</span>
      <span class="na">p:baseDn-ref=</span><span class="s">"baseDn"</span>
      <span class="na">p:searchFilter-ref=</span><span class="s">"searchFilter"</span><span class="nt">/&gt;</span>

<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"searchFilter"</span> <span class="na">class=</span><span class="s">"org.ldaptive.SearchFilter"</span>
      <span class="na">c:filter=</span><span class="s">"host={0}"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"baseDn"</span> <span class="na">class=</span><span class="s">"java.lang.String"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">type=</span><span class="s">"java.lang.String"</span> <span class="na">value=</span><span class="s">"${ldap.baseDn}"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span></code></pre></figure>

<h3 id="webflow-configuration">Webflow Configuration</h3>

<p>Insert the appropriate action before SPNEGO initiation, assigning a <code class="language-plaintext highlighter-rouge">yes</code> response route to SPNEGO, and a <code class="language-plaintext highlighter-rouge">no</code> response to route to viewing the login form.</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;action-state</span> <span class="na">id=</span><span class="s">"eveluateClientRequest"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;evaluate</span> <span class="na">expression=</span><span class="s">"hostnameSpnegoClientAction"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;transition</span> <span class="na">on=</span><span class="s">"yes"</span> <span class="na">to=</span><span class="s">"startAuthenticate"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;transition</span> <span class="na">on=</span><span class="s">"no"</span> <span class="na">to=</span><span class="s">"generateLoginTicket"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/action-state&gt;</span>

...</code></pre></figure>


                </div>
            </section>
        </main>
    </div>
</div>


<footer>
    <div class="container">
        CAS is supported by the <a href="https://www.apereo.org/">Apereo Foundation</a>.
    </div>
</footer>

<script>
    let pageSection = '';
</script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.2/js/tether.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script>

<script src="../../javascripts/URI.js"></script>
<script src="../../javascripts/main.js"></script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
</body>

</html>
