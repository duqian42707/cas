<!DOCTYPE html>
<html>

<head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="CAS - Enterprise Single Sign-On for the Web"/>
    <meta name="keywords" content="authentication, login, cas, central authentication service, web, java, protocol, thymeleaf,
                   open source, boot, spring, authorization, google, facebook, twitter, higher-ed, enterprise,
                   access management, single signon, sso, RBAC, ABAC, attributes, SAML, OpenID, openid connect,
                   JWT, ADFS"/>
    <meta name="robots" content="index,follow"/>

    
    

        
    


    

    <script>
        ((i, s, o, g, r, a, m) => {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-83384532-2', 'auto');
        ga('send', 'pageview');

    </script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/>

    <link rel="stylesheet" type="text/css" media="screen" href="../../stylesheets/stylesheet.css">
    <link rel="stylesheet" type="text/css" media="print" href="../../stylesheets/print.css">

    <link href='https://fonts.googleapis.com/css?family=Lato:400,300,700' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic&subset=latin-ext,latin' rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" rel="stylesheet">

    <title>CAS - Adaptive Risk-based Authentication</title>

</head>

<body>
<!-- HEADER -->
<header class="hidden-sm-down">
    <div class="container">
        <div class="row">
            <div class="col-xs-4 col-md-2">
                <a href="../../index.html">
                    <img class="undecorated" src="../../images/cas_logo.png"/>
                </a>
            </div>
            <div class="col-xs-8 col-md-6">
                <h1>Enterprise Single Sign-On for All</h1>
            </div>
            <div class="hidden-sm-down col-md-4">
                <a id="forkme_banner" href="https://github.com/apereo/cas">View on GitHub</a>
            </div>

        </div>
    </div>
</header>

<!-- NAVBAR -->

<nav class="navbar navbar-expand-md navbar-dark bg-primary bg-dark">
    <div class="container">
        <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="navbar-collapse collapse" id="navbarsExample04">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active"><a href="../../index.html" class="zoom nav-link">Home</a></li>
                <li class="nav-item"><a href="https://github.com/apereo/cas/releases" class="zoom nav-link">Releases</a></li>
                <li class="nav-item"><a href="../../Support.html" class="zoom nav-link">Support</a></li>
                <li class="nav-item"><a href="../../Mailing-Lists.html" class="zoom nav-link">Mailing Lists</a></li>
                <li class="nav-item">
                    <a class="zoom nav-link" href="../../Demos.html">Demos</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="zoom nav-link dropdown-toggle mr-md-2" href="#" id="cas-versions" data-bs-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">Versions</a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="cas-versions">
                        
                        
                        <a class="dropdown-item" href="/cas/development/">Development</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.6.x/">v6.6.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.5.x/">v6.5.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.4.x/">v6.4.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.3.x/">v6.3.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.2.x/">v6.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.1.x/">v6.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.0.x/">v6.0.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.3.x/">v5.3.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.2.x/">v5.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.1.x/">v5.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.0.x/">v5.0.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.2.x/">v4.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.1.x/">v4.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.0.x/">v4.0.x</a>
                        
                        

                    </div>
                </li>
                <li class="nav-item"><a href="https://apereo.github.io" target="_blank" class="zoom nav-link">Blog</a></li>
            </ul>

        </div>

    </div>
</nav>


<div class="container-fluid">
    <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 docs-sidebar pb-5" id="sidebar"></div>


        <div class="d-none d-xl-block col-xl-2 docs-toc">
    <div id="pageContents">
        <ul class="section-nav"></ul>
    </div>
</div>


        <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 cas-docs-content" role="main">


            

            <section>
                <nav id="docsNavBar">
                    <span id="toolbarIcons"></span>
                </nav>

                <div id="cas-docs-container">
                    <h1 id="risk-based-authentication">Risk-based Authentication</h1>

<p>Risk-based authentication allows CAS to detect suspicious and seemingly-fraudulent authentication requests based on past user behavior
and collected authentication events, statistics, etc. Once and <em>after</em> primary authentication where the principal is identified,
the authentication transaction is analyzed via a number of configurable criteria and fences to determine how <em>risky</em> the attempt may be.
The result of the evaluation step is a cumulative risk score that is then weighed against a risk threshold set by the CAS operator.
In the event that the authentication attempt is considered risky well beyond the risk threshold, CAS may be allowed to take action and
mitigate that risk.</p>

<p>Simply put, the story told is:</p>

<blockquote>
  <p>If an authentication request is at least [X%] risky, take action to mitigate that risk.</p>
</blockquote>

<p>The functionality of this feature is <strong>ENTIRELY</strong> dependent upon collected statistics and authentication events in the past.
Without data, there is nothing to analyze and no risk to detect.</p>

<p>Note that evaluation of attempts and mitigation of risks are all recorded in the audit log.</p>

<div class="alert alert-info"><strong>Adaptive Authentication</strong><p>
If you need to preemptively evaluate authentication attempts based on various characteristics of the request,
you may be interested in <a href="../mfa/Configuring-Adaptive-Authentication.html">this guide</a> instead.</p></div>

<h2 id="risk-calculation">Risk Calculation</h2>

<p>One or more risk calculators may be enabled to allow an analysis of authentication requests.</p>

<p>A high-level explanation of the risk calculation strategy follows:</p>

<ul>
  <li>If there is no recorded event at all present for the principal, consider the request suspicious.</li>
  <li>If the number of recorded events for the principal based on the active criteria matches the total number of events, consider the
request safe.</li>
</ul>

<h3 id="ip-address">IP Address</h3>

<p>This calculator looks into past authentication events that match the client ip address. It is applicable if you wish
to consider authentication requests from unknown ip addresses suspicious for the user. The story here is:</p>

<blockquote>
  <p>Find all past authentication events that match the current client ip address and calculate an averaged score.</p>
</blockquote>

<h3 id="browser-user-agent">Browser User Agent</h3>

<p>This calculator looks into past authentication events that match the clientâ€™s <code class="language-plaintext highlighter-rouge">user-agent</code> string. It is applicable if you wish
to consider authentication requests from unknown browsers suspicious for the user. The story here is:</p>

<blockquote>
  <p>Find all past authentication events that match the current client browser and calculate an averaged score.</p>
</blockquote>

<h3 id="geolocation">Geolocation</h3>

<p>This calculator looks into past authentication events that contain geolocation data, and compares those with the current geolocation.
If current geolocation data is unavailable, it will attempt to geocode the location based on the current client ip address. This feature
mostly depends on whether or not geodata is made available to CAS via the client browser.   The story here is:</p>

<blockquote>
  <p>Find all past authentication events that match the current client location and calculate an average score.</p>
</blockquote>

<h3 id="datetime">Date/Time</h3>

<p>This calculator looks into past authentication events that fit within the defined time-window. It is applicable if you wish
to consider authentication requests outside that window suspicious for the user. The story here is:</p>

<blockquote>
  <p>Find all past authentication events that are established X hours before/after now and calculate an averaged score.</p>
</blockquote>

<h2 id="risk-mitigation">Risk Mitigation</h2>

<p>Once an authentication attempt is deemed risky, a contingency plan may be enabled to mitigate risk. If configured and allowed,
CAS may notify both the principal and deployer via both email and sms.</p>

<h3 id="block-authentication">Block Authentication</h3>

<p>Prevent the authentication flow to proceed and disallow the establishment of the SSO session.</p>

<h3 id="multifactor-authentication">Multifactor Authentication</h3>

<p>Force the authentication event into a <a href="../mfa/Configuring-Multifactor-Authentication.html">multifactor flow of choice</a>,
identified by the provider id.</p>

<h2 id="configuration">Configuration</h2>

<p>Support is enabled by including the following dependency in the overlay:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apereo.cas<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>cas-server-support-electrofence<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>${cas.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#risk-based-authentication">review this guide</a>.</p>

<h3 id="messaging--notifications">Messaging &amp; Notifications</h3>

<p>Users may be notified of risky authentication attempts via text messages and/or email.
To learn more about available options, please <a href="../notifications/SMS-Messaging-Configuration.html">see this guide</a>
or <a href="../notifications/Sending-Email-Configuration.html">this guide</a>.</p>

<h3 id="remember">Remember</h3>

<ul>
  <li>You <strong>MUST</strong> allow and configure CAS to track and record <a href="Configuring-Authentication-Events.html">authentication events</a>.</li>
  <li>You <strong>MUST</strong> allow and configure CAS to <a href="GeoTracking-Authentication-Requests.html">geolocate authentication requests</a>.</li>
  <li>If the selected contingency plan is to force the user into a multifactor authentication flow, you then <strong>MUST</strong> configure CAS for
<a href="../mfa/Configuring-Multifactor-Authentication.html">multifactor authentication</a> and the relevant provider.</li>
</ul>

                </div>
            </section>
        </main>
    </div>
</div>


<footer>
    <div class="container">
        CAS is supported by the <a href="https://www.apereo.org/">Apereo Foundation</a>.
    </div>
</footer>

<script>
    let pageSection = 'Authentication';
</script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.2/js/tether.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script>

<script src="../../javascripts/URI.js"></script>
<script src="../../javascripts/main.js"></script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
</body>

</html>
