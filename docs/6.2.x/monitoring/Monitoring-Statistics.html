<!DOCTYPE html>
<html>

<head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="CAS - Enterprise Single Sign-On for the Web"/>
    <meta name="keywords" content="authentication, login, cas, central authentication service, web, java, protocol, thymeleaf,
                   open source, boot, spring, authorization, google, facebook, twitter, higher-ed, enterprise,
                   access management, single signon, sso, RBAC, ABAC, attributes, SAML, OpenID, openid connect,
                   JWT, ADFS"/>
    <meta name="robots" content="index,follow"/>

    
    

        
    


    

    <script>
        ((i, s, o, g, r, a, m) => {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-83384532-2', 'auto');
        ga('send', 'pageview');

    </script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/>

    <link rel="stylesheet" type="text/css" media="screen" href="../../stylesheets/stylesheet.css">
    <link rel="stylesheet" type="text/css" media="print" href="../../stylesheets/print.css">

    <link href='https://fonts.googleapis.com/css?family=Lato:400,300,700' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic&subset=latin-ext,latin' rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" rel="stylesheet">

    <title>CAS - Monitoring & Statistics</title>

</head>

<body>
<!-- HEADER -->
<header class="hidden-sm-down">
    <div class="container">
        <div class="row">
            <div class="col-xs-4 col-md-2">
                <a href="../../index.html">
                    <img class="undecorated" src="../../images/cas_logo.png"/>
                </a>
            </div>
            <div class="col-xs-8 col-md-6">
                <h1>Enterprise Single Sign-On for All</h1>
            </div>
            <div class="hidden-sm-down col-md-4">
                <a id="forkme_banner" href="https://github.com/apereo/cas">View on GitHub</a>
            </div>

        </div>
    </div>
</header>

<!-- NAVBAR -->

<nav class="navbar navbar-expand-md navbar-dark bg-primary bg-dark">
    <div class="container">
        <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="navbar-collapse collapse" id="navbarsExample04">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active"><a href="../../index.html" class="zoom nav-link">Home</a></li>
                <li class="nav-item"><a href="https://github.com/apereo/cas/releases" class="zoom nav-link">Releases</a></li>
                <li class="nav-item"><a href="../../Support.html" class="zoom nav-link">Support</a></li>
                <li class="nav-item"><a href="../../Mailing-Lists.html" class="zoom nav-link">Mailing Lists</a></li>
                <li class="nav-item">
                    <a class="zoom nav-link" href="../../Demos.html">Demos</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="zoom nav-link dropdown-toggle mr-md-2" href="#" id="cas-versions" data-bs-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">Versions</a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="cas-versions">
                        
                        
                        <a class="dropdown-item" href="/cas/development/">Development</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.6.x/">v6.6.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.5.x/">v6.5.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.4.x/">v6.4.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.3.x/">v6.3.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.2.x/">v6.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.1.x/">v6.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/6.0.x/">v6.0.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.3.x/">v5.3.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.2.x/">v5.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.1.x/">v5.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/5.0.x/">v5.0.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.2.x/">v4.2.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.1.x/">v4.1.x</a>
                        
                        
                        
                        <a class="dropdown-item" href="/cas/4.0.x/">v4.0.x</a>
                        
                        

                    </div>
                </li>
                <li class="nav-item"><a href="https://apereo.github.io" target="_blank" class="zoom nav-link">Blog</a></li>
            </ul>

        </div>

    </div>
</nav>


<div class="container-fluid">
    <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 docs-sidebar pb-5" id="sidebar"></div>


        <div class="d-none d-xl-block col-xl-2 docs-toc">
    <div id="pageContents">
        <ul class="section-nav"></ul>
    </div>
</div>


        <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 cas-docs-content" role="main">


            

            <section>
                <nav id="docsNavBar">
                    <span id="toolbarIcons"></span>
                </nav>

                <div id="cas-docs-container">
                    <h1 id="monitoring--statistics">Monitoring / Statistics</h1>

<p>Actuator endpoints used to monitor and diagnose the internal configuration of the CAS server are typically
exposed over the endpoint <code class="language-plaintext highlighter-rouge">/actuator</code>.</p>

<h2 id="spring-boot-endpoints">Spring Boot Endpoints</h2>

<p>The following endpoints are secured and available by 
<a href="http://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html">Spring Boot actuators</a>:</p>

<table>
  <thead>
    <tr>
      <th>Endpoint</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">autoconfig</code></td>
      <td>Describes how the CAS application context is auto-configured.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">beans</code></td>
      <td>Displays all CAS application context <strong>internal</strong> Spring beans.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">conditions</code></td>
      <td>Shows the conditions that were evaluated on configuration and auto-configuration classes and the reasons why they did or did not match.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">configprops</code></td>
      <td>List of <strong>internal</strong> configuration properties.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">threaddump</code></td>
      <td>Produces a thread dump for the running CAS server.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">env</code></td>
      <td>Produces a collection of all application properties.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">health</code></td>
      <td>Reports back general health status of the system, produced by various monitors.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">info</code></td>
      <td>CAS version information and other system traits.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">metrics</code></td>
      <td>Runtime metrics and stats.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">httptrace</code></td>
      <td>Displays HTTP trace information (by default, the last 100 HTTP request-response exchanges).</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">mappings</code></td>
      <td>Describes how requests are mapped and handled by CAS.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">scheduledtasks</code></td>
      <td>Displays the scheduled tasks in CAS.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">shutdown</code></td>
      <td>Shut down the application via a <code class="language-plaintext highlighter-rouge">POST</code>. Disabled by default.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">restart</code></td>
      <td>Restart the application via a <code class="language-plaintext highlighter-rouge">POST</code>. Disabled by default.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">refresh</code></td>
      <td>Refresh the application configuration via a <code class="language-plaintext highlighter-rouge">POST</code> to let components reload and recognize new values.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">heapdump</code></td>
      <td>Returns a GZip compressed hprof heap dump file.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">jolokia</code></td>
      <td>Exposes JMX beans over HTTP when Jolokia is configured and included in CAS.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">logfile</code></td>
      <td>Returns the contents of the log file if <code class="language-plaintext highlighter-rouge">logging.file</code> or <code class="language-plaintext highlighter-rouge">logging.path</code> properties are set with support for HTTP <code class="language-plaintext highlighter-rouge">Range</code> header.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">prometheus</code></td>
      <td>Exposes metrics in a format that can be scraped by a Prometheus server.</td>
    </tr>
  </tbody>
</table>

<div class="alert alert-info"><strong>Exposed Endpoints</strong><p>
Note that by default the only endpoints exposed over the web are <code>info</code>, <code>status</code>, <code>health</code> and <code>configurationMetadata</code>.
Other endpoints need to be explicitly <strong>enabled and then exposed over the web</strong> in CAS settings in order to allow access.
</p></div>

<p>Actuator endpoints provided by Spring Boot can also be visually managed and monitored
 via the <a href="Configuring-Monitoring-Administration.html">Spring Boot Administration Server</a>.</p>
<div class="alert alert-info"><strong>Obtaining Health Info</strong><p>Note that <code>/status</code> endpoint is kept mostly 
as a legacy endpoint. If you wish to obtain health status of each monitor in detail, we recommend the <code>/actuator/health</code> endpoint instead.</p></div>

<h2 id="cas-endpoints">CAS Endpoints</h2>

<p>The default set of CAS actuator endpoints can be turned in by including the following dependency in the WAR overlay:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apereo.cas<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>cas-server-support-reports<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>${cas.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Note that certain CAS features present actuator endpoints of their own, and such endpoints only become active
once the feature is turned on and made available to CAS at runtime. For more information, refer to the specific
documentation page for the feature in question to learn more about administrative endpoints, etc.</p>

<h2 id="metrics">Metrics</h2>

<p>Metrics allow to gain insight into the running CAS software, and provide ways to measure the behavior of critical components. 
See <a href="Configuring-Metrics.html">this guide</a> for more info.</p>

<p>Navigating to <code class="language-plaintext highlighter-rouge">/actuator/metrics</code> displays a list of available meter names. You can drill down to view information about a 
particular meter by providing its name as a selector, e.g. <code class="language-plaintext highlighter-rouge">/actuator/metrics/jvm.memory.max</code>.  The name you use here should match 
the name used in the code, not the name after it has been naming-convention normalized for a monitoring system it is shipped to.</p>

<p>You can also add any number of <code class="language-plaintext highlighter-rouge">tag=KEY:VALUE</code> query parameters to the end of the URL to dimensionally drill 
down on a meter, e.g. <code class="language-plaintext highlighter-rouge">/actuator/metrics/jvm.memory.max?tag=area:nonheap</code></p>

<p>The reported measurements are the sum of the statistics of all meters matching the meter name and any tags that have been applied. 
So in the example above, the returned “Value” statistic is the sum of the maximum memory footprints of “Code Cache”, 
“Compressed Class Space”, and “Metaspace” areas of the heap. If you just wanted to see the maximum size for the “Metaspace”, 
you could add an additional <code class="language-plaintext highlighter-rouge">tag=id:Metaspace</code>, i.e. <code class="language-plaintext highlighter-rouge">/actuator/metrics/jvm.memory.max?tag=area:nonheap&amp;tag=id:Metaspace</code>.</p>

<h2 id="security">Security</h2>

<p>Once endpoints are enabled and exposed, the security of all provided endpoints is handled 
by <a href="https://spring.io/projects/spring-security">Spring Security</a>. Protection and access to each endpoint
is controlled via CAS settings individually such that you may decide a specific security level and method of authentication for each endpoint independently.</p>

<p>If CAS is configured to <em>NOT</em> enforce endpoint security rules, then all endpoints are considered sensitive and require authentication, typically handled
via basic authentication with master credentials defined in CAS settings.</p>

<p>If CAS is configured to enforce endpoint security rules, then each endpoint may be tagged with a specific security rule allowing access via authorized IP addresses,
basic credentials, roles and attributes, etc.</p>

<p>Authentication credentials are typically controlled via CAS settings. For basic authentication, the default username is <code class="language-plaintext highlighter-rouge">casuser</code>. The password 
may be automatically generated at startup and displayed in CAS logs if it is left undefined in CAS settings. Additional sources may also be defined
that would authenticate the request via JAAS, LDAP, JDBC, etc.</p>

<p>Depending on method of access and the <code class="language-plaintext highlighter-rouge">content-type</code> that is negotiated between the caller and CAS, (i.e. web-based vs. command-line access), 
credentials may be supplied in headers via <code class="language-plaintext highlighter-rouge">curl</code> and family or they may be entered into a web-based login form.</p>

<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#actuator-management-endpoints">review this guide</a>.</p>

<h3 id="troubleshooting">Troubleshooting</h3>

<p>To enable additional logging, configure the log4j configuration file to add the following
levels:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>...
<span class="nt">&lt;AsyncLogger</span> <span class="na">name=</span><span class="s">"org.pac4j"</span> <span class="na">level=</span><span class="s">"debug"</span> <span class="na">additivity=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;AppenderRef</span> <span class="na">ref=</span><span class="s">"console"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;AppenderRef</span> <span class="na">ref=</span><span class="s">"file"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/AsyncLogger&gt;</span>
<span class="nt">&lt;AsyncLogger</span> <span class="na">name=</span><span class="s">"org.springframework.security"</span> <span class="na">level=</span><span class="s">"debug"</span> <span class="na">additivity=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;AppenderRef</span> <span class="na">ref=</span><span class="s">"console"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;AppenderRef</span> <span class="na">ref=</span><span class="s">"file"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/AsyncLogger&gt;</span>
...
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="distributed-tracing">Distributed Tracing</h2>

<p>Support for distributed tracing of requests is enabled by including the following dependency in the WAR overlay:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;dependency&gt;</span>
     <span class="nt">&lt;groupId&gt;</span>org.apereo.cas<span class="nt">&lt;/groupId&gt;</span>
     <span class="nt">&lt;artifactId&gt;</span>cas-server-support-sleuth<span class="nt">&lt;/artifactId&gt;</span>
     <span class="nt">&lt;version&gt;</span>${cas.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cloud.githubusercontent.com/assets/1205228/24955152/8798ad9c-1f97-11e7-8b9d-fccc3c306c42.png" alt="image" /></p>

<p>For most users <a href="https://cloud.spring.io/spring-cloud-sleuth/">Sleuth</a> should be invisible, and all
interactions with external systems should be instrumented automatically.</p>

<p>Trace data is captured automatically and passed along to <a href="https://github.com/openzipkin/zipkin">Zipkin</a>, which helps 
gather timing data needed to troubleshoot latency problems.</p>

<p>To see the relevant list of CAS properties, please <a href="../configuration/Configuration-Properties.html#sleuth-distributed-tracing">review this guide</a>.</p>

<h3 id="troubleshooting-1">Troubleshooting</h3>

<p>To enable additional logging, modify the logging configuration file to add the following:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre> <span class="nt">&lt;AsyncLogger</span> <span class="na">name=</span><span class="s">"org.springframework.cloud"</span> <span class="na">level=</span><span class="s">"debug"</span> <span class="na">additivity=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;AppenderRef</span> <span class="na">ref=</span><span class="s">"casConsole"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;AppenderRef</span> <span class="na">ref=</span><span class="s">"casFile"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/AsyncLogger&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>


                </div>
            </section>
        </main>
    </div>
</div>


<footer>
    <div class="container">
        CAS is supported by the <a href="https://www.apereo.org/">Apereo Foundation</a>.
    </div>
</footer>

<script>
    let pageSection = 'Monitoring & Statistics';
</script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.2/js/tether.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script>

<script src="../../javascripts/URI.js"></script>
<script src="../../javascripts/main.js"></script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
</body>

</html>
